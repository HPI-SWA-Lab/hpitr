% \iffalse meta-comment
% ============================================================================
% hpitr.dtx
% Copyright (c) Daniel Richter, Uwe Hentschel 2013-2014
% Copyright (c) Tobias Pape, 2014-2015
%
% This work may be distributed and/or modified under the conditions of
% the LaTeX Project Public License, version 1.3c of the license.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3c or later is part of all distributions of LaTeX 
% version 2005/12/01 or later.
%
% This work has the LPPL maintenance status "maintained".
%
% The Current Maintainer and author of this work is Tobias Pape.
%
% This work consists of the file `hpitr.dtx'.
%
%^^A ==========================================================================
%^^A ==========================================================================
%^^A ==========================================================================
% \fi^^A meta-comment
% \CharacterTable
%  {Upper-case    \A\B\C\D\E\F\G\H\I\J\K\L\M\N\O\P\Q\R\S\T\U\V\W\X\Y\Z
%   Lower-case    \a\b\c\d\e\f\g\h\i\j\k\l\m\n\o\p\q\r\s\t\u\v\w\x\y\z
%   Digits        \0\1\2\3\4\5\6\7\8\9
%   Exclamation   \!     Double quote  \"     Hash (number) \#
%   Dollar        \$     Percent       \%     Ampersand     \&
%   Acute accent  \'     Left paren    \(     Right paren   \)
%   Asterisk      \*     Plus          \+     Comma         \,
%   Minus         \-     Point         \.     Solidus       \/
%   Colon         \:     Semicolon     \;     Less than     \<
%   Equals        \=     Greater than  \>     Question mark \?
%   Commercial at \@     Left bracket  \[     Backslash     \\
%   Right bracket \]     Circumflex    \^     Underscore    \_
%   Grave accent  \`     Left brace    \{     Vertical bar  \|
%   Right brace   \}     Tilde         \~}
% \CheckSum{4931}
%
% \iffalse meta-comment
%<*dtx|ins>
\expandafter\ifx\csname ProvidesFile\endcsname\relax
  \def\ProvidesFile#1[#2]{\message{#1: #2}}%
\fi
%</dtx|ins>
%<class>\NeedsTeXFormat{LaTeX2e}[1995/12/01]
%<class>\ProvidesClass{hpitr}%
%<*dtx|ins|doc|manual>
\ProvidesFile{%
  hpitr%
%<manual>  -manual%
%<*dtx>
  .dtx%
%</dtx>
%<ins>  .ins%
%<doc>  .ltx%
}%
%</dtx|ins|doc|manual>
%<*dtx|ins|doc|class|README>
%<README>hpitr
%<README>  Copyright (c) Tobias Pape <tobias.pape at hpi.de>
%<*!README>
[%
%</!README>
  2015/03/26 v1.1b
%<!README>^^J
  A unified class for Technical Reports at the HPI
%<*!README>
]
%</!README>
%</dtx|ins|doc|class|README>
% \fi^^A meta-comment
% ^^A -------------------------------------------------------------------------
%
%
%
%
% \changes{v0.1}{2014/06/01}{Initial class derived from polze.cls}
% \changes{v0.2}{2014/07/10}{Minimal changes to play nice with babel and
% subcaption}
% \changes{v0.5}{2014/08/15}{Small fixes to abstract and title, loading of float}
% \changes{v0.6}{2014/08/27}{Provide \cs{keywords} command.}
% \changes{v0.7}{2014/09/04}{Discriminate between proceedings and collections}
% \changes{v0.9}{2014/09/30}{Add inproceedings pseudo-trtype}
% \changes{v1.0}{2015/01/15}{First release}
% \changes{v1.1}{2015/02/13}{golden ratio text block, record prc, make
% copyright an option, inproceedings example}
% \changes{v1.1a}{2015/03/24}{Compatibility for older \TeX en}
% \changes{v1.1b}{2015/03/26}{Font load order}
%
% \GetFileInfo{hpitr.dtx}
%^^A ==========================================================================
%^^A ==========================================================================
%^^A ==========================================================================
%
%\makeatletter
% ^^A Heiko Oberdiek's fix from latexbugs (latex/3540):
%\begingroup
%  \def\x\begingroup#1\@nil{\endgroup
%    \def\DoNotIndex{\begingroup
%      \@tfor\@tempa:=\#\$\&\^\_\|\~\ \<\do{\expandafter\@makeother\@tempa}#1}}
%\expandafter\x\DoNotIndex\@nil
%\def\PercentIndex{}\def\LeftBraceIndex{}\def\RightBraceIndex{}
%
% ^^A Non-Index list derived from microtype.dtx and titlepage.dtx
%
%  \DoNotIndex{\!,\",\',\(,\),\*,\+,\,,\-,\.,\/,\:,\;,\<,\=,\>,\?,\[,\\,\],\`,
%  \#,\$,\&,\^,\_,\|,\~,\ ,\@Alph,\@M,
%  \advance,\afterassignment,\aftergroup,\begingroup,\bgroup,\catcode,\char,
%  \chardef,\csname,\def,\divide,\edef,\egroup,\else,\endcsname,\endgroup,
%  \endinput,\escapechar,\everypar,\expandafter,\fi,\futurelet,\gdef,\global,
%  \hbadness,\hbox,\hsize,\hskip,\if,\ifcase,\ifcat,\ifdim,\iffalse,\ifhbox,
%  \ifhmode,\ifmmode,\ifnum,\iftrue,\ifx,\immediate,\input,\inputlineno,
%  \jobname,\kern,\lastkern,\lastskip,\let,\lowercase,\maxdimen,\meaning,
%  \multiply,\newlinechar,\noexpand,\number,\or,\parfillskip,\pretolerance,
%  \relax,\setbox,\showboxdepth,\string,\the,\tolerance,\unkern,\unskip,
%  \uppercase,\vbox,\wd,\write,\xdef,\font,\fontdimen,\nullfont,\sfcode,
%  \spacefactor,\spaceskip,\xspaceskip}
%  \DoNotIndex{\detokenize,\dimexpr,\eTeXversion,\ifcsname,\ifdefined,\numexpr}
%  \DoNotIndex{\@backslashchar,\@cclv,\@cclvi,\@classoptionslist,\@currext,
%  \@currname,\@defaultunits,\@empty,\@expandtwoargs,\@firstofone,\@firstoftwo,
%  \@gobble,\@gobbletwo,\@ifl@aded,\@ifpackagelater,\@ifpackageloaded,\@ifstar,
%  \@ifundefined,\@let@token,\@m,\@makeother,\@minus,\@nameuse,\@ne,\@nil,\@nnil,
%  \@onelevel@sanitize,\@onlypreamble,\@percentchar,\@pkgextension,\@plus,
%  \@ptionlist,\@removeelement,\@secondoftwo,\@spaces,\@sptoken,\@tempa,\@tempb,
%  \@tempc,\@tempcnta,\@tempcntb,\@tempdima,\@typeset@protect,\@undefined,
%  \@unprocessedoptions,\@unusedoptionlist,\@xobeysp,\check@icr,\color@begingroup,
%  \color@endgroup,\g@addto@macro,\hmode@bgroup,\m@ne,\maybe@ic,\maybe@ic@,
%  \nfss@text,\not@math@alphabet,\on@line,\p@,\set@display@protect,\strip@prefix,
%  \strip@pt,\tw@,\z@,\z@skip,\zap@space,\active,\documentclass,\leavevmode,
%  \makeatletter,\mbox,\newcommand,\newcount,\newdimen,\newif,\newskip,
%  \newtoks,\nobreak,\nonfrenchspacing,\normalsize,\renewcommand,\space,
%  \AtBeginDocument,\AtEndOfPackage,\CheckCommand,\CurrentOption,
%  \DeclareRobustCommand,\IfFileExists,\InputIfFileExists,\MessageBreak,
%  \PackageError,\PackageInfo,\PackageWarning,\RequirePackage,
%  \@@enc@update,\cf@encoding,\f@encoding}
%  \DoNotIndex{\foreign@language,\languagename,\select@language,\shorthandoff}
%  \DoNotIndex{\pdfstringdefDisableCommands,\pdfstringdefWarn} ^^A hyperref
%  \DoNotIndex{\ifpdf} ^^A ifpdf
%
%  \DoNotIndex{\wd,\xdef,\year,\z@}
%  \DoNotIndex{\@abstrtfalse,\@abstrttrue,\@addtoreset,\@afterheading}
%  \DoNotIndex{\@afterindentfalse,\@alph,\@arabic}
%  \DoNotIndex{\@beginparpenalty}
%  \DoNotIndex{\@car,\@cdr,\@centercr}
%  \DoNotIndex{\@dblfloat,\@dotsep}
%  \DoNotIndex{\@dottedtocline,\@empty,\@endparpenalty}
%  \DoNotIndex{\@float,\@fontswitch}
%  \DoNotIndex{\@gobbletwo}
%  \DoNotIndex{\@hangfrom,\@highpenalty}
%  \DoNotIndex{\@ifnextchar,\@ifundefined,\@itempenalty}
%  \DoNotIndex{\@latex@warning}
%  \DoNotIndex{\@m,\@medpenalty,\@minus,\@mkboth,\@mparswitchfalse}
%  \DoNotIndex{\@mparswitchtrue}
%  \DoNotIndex{\@ne,\@nil,\@nobreakfalse,\@nobreaktrue,\@nomath}
%  \DoNotIndex{\@plus}
%  \DoNotIndex{\@tempa,\@tempcnta,\@tempdima,\@tempskipka}
%  \DoNotIndex{\@tempswafalse,\@tempswatrue}
%  \DoNotIndex{\@tempb,\@tempcntb,\@tempdimb,\@tempskipkb}
%  \DoNotIndex{\@tempswbfalse,\@tempswbtrue}
%  \DoNotIndex{\@tempc,\@tempcntc,\@tempdimc,\@tempskipkc}
%  \DoNotIndex{\@tocrmarg,\@topnewpage,\@topnum,\@twocolumnfalse}
%  \DoNotIndex{\@twocolumntrue,\@twosidefalse,\@twosidetrue}
%  \DoNotIndex{\@whiledim,\@whilenum}
%  \DoNotIndex{\addcontentsline,\addpenalty,\addtocontents,\addtolength}
%  \DoNotIndex{\addvspace,\advance}
%  \DoNotIndex{\begin,\begingroup,\bfseries,\box,\bullet}
%    \DoNotIndex{\c@figure,\c@page,\c@secnumdepth,\c@table,\c@tocdepth}
%    \DoNotIndex{\cdot,\centering,\changes,\cleardoublepage,\clearpage}
%    \DoNotIndex{\cmd,\col@number,\CurrentOption,\CodelineIndex,\cs}
%    \DoNotIndex{\day,\dblfloatpagefraction,\dbltopfraction}
%    \DoNotIndex{\DeclareOldFontCommand,\DeclareOption,\def,\DisableCrossrefs}
%    \DoNotIndex{\divide,\DoNotIndex}
%    \DoNotIndex{\ifdim,\else,\fi,\empty,\em,\EnableCrossrefs,\end}
%  \DoNotIndex{\end@dblfloat}
% \DoNotIndex{\end@float,\endgroup,\endlist,\endquotation,\endtitlepage}
% \DoNotIndex{\everypar,\ExecuteOptions,\expandafter}
% \DoNotIndex{\fboxrule,\fboxsep}
%  \DoNotIndex{\gdef,\global}
% \DoNotIndex{\hangindent,\hbox,\hfil,\hrule,\hsize,\hskip,\hspace,\hss}
% \DoNotIndex{\if@tempswa,\ifcase,\or,\fi,\fi}
% \DoNotIndex{\ifnum,\ifodd,\ifx,\fi,\fi,\fi}
% \DoNotIndex{\include,\input,\InputIfFileExists,\item,\itshape}
% \DoNotIndex{\kern,\leavevmode,\leftmark,\leftskip,\let,\lineskip}
% \DoNotIndex{\list,\long}
% \DoNotIndex{\m@ne,\m@th,\marginpar,\markboth,\markright,\mathbf,\mathcal}
% \DoNotIndex{\mathit,\mathnormal,\mathrm,\mathsf,\mathtt,\MessageBreak}
% \DoNotIndex{\month}
% \DoNotIndex{\newblock,\newcommand,\newcount,\newcounter,\newdimen}
% \DoNotIndex{\newenvironment,\newlength,\newpage,\nobreak,\noindent}
% \DoNotIndex{\normalfont,\normallineskip,\normalsize,\null,\number}
% \DoNotIndex{\numberline,\normalcolor}
% \DoNotIndex{\OldMakeindex,\OnlyDescription,\overfullrule}
% \DoNotIndex{\p@,\PackageError,\PackageInfo,\PackageWarningNoLine}
% \DoNotIndex{\pagenumbering,\pagestyle,\par,\paragraph,\parbox}
% \DoNotIndex{\PassOptionsToPackage,\pcal,\penalty,\pmit,\PrintChanges}
% \DoNotIndex{\PrintIndex,\ProcessOptions,\protect,\providecommand}
% \DoNotIndex{\ProvidesClass}
% \DoNotIndex{\raggedbottom,\raggedleft,\raggedright,\refstepcounter,\relax}
% \DoNotIndex{\renewcommand,\RequirePackage,\reset@font}
% \DoNotIndex{\rightmargin,\rightmark,\rightskip,\rmfamily,\@Roman,\@roman}
% \DoNotIndex{\scshape,\secdef,\setbox,\setcounter,\setlength}
% \DoNotIndex{\settowidth,\sfcode,\sffamily,\skip,\sloppy,\slshape,\space}
% \DoNotIndex{\string}
% \DoNotIndex{\the,\thispagestyle,\triangleright,\ttfamily}
% \DoNotIndex{\twocolumn,\typeout}
%  \DoNotIndex{\undefined,\usecounter}
% \DoNotIndex{\vfil,\vfill,\vspace}
%  \DoNotIndex{\ifthenelse,\OR,\AND,\boolean}
% \makeatother
%
%^^A ==========================================================================
%^^A ==========================================================================
%^^A ==========================================================================
% \StopEventually{
%  \newpage
%  \appendix
%  \PrintChanges
%  \PrintIndex
% }
%
% \section{Implementation}
% \label{sec:Implementation}
%
% \subsection{The Installation Driver `\protect\File{hpitr.ins}'}
% \label{sec:hpitr-ins}
% \iffalse meta-comment
%<*dtx|ins>
% \fi ^^A meta-comment
% First of all we produce \File{hpitr.ins}, the installation driver. It
% starts very common with loading \File{docstrip}, preamble declaration and
% start of generation.
%    \begin{macrocode}
\def\batchfile{hpitr.dtx}
\input docstrip.tex
\ifToplevel{%
  \Msg{********************************************************************}
  \Msg{*}
  \Msg{* Steps of hpitr generation:}
  \Msg{* ==========================}
  \Msg{*}
  \Msg{* - Generation of all needed files:}
  \keepsilent
  \askforoverwritefalse
}

\preamble
Copyright (c) Daniel Richter, Uwe Hentschel 2013-2014
Copyright (c) Tobias Pape, 2014-2015

This file was generated from file(s) of hpitr distribution.
----------------------------------------------------------------------

This work may be distributed and/or modified under the conditions of
the LaTeX Project Public License, version 1.3c of the license.
The latest version of this license is in
  http://www.latex-project.org/lppl.txt
and version 1.3c or later is part of all distributions of LaTeX 
version 2005/12/01 or later.

This work has the LPPL maintenance status "maintained".

The Current Maintainer and author of this work is Tobias Pape.

This file may only be distributed together with the file
`hpitr.dtx'. You may however distribute the file `hpitr.dtx' 
without this file.
\endpreamble

\generate{%
%    \end{macrocode}
% But while the dtx file is the ins file itself, we will never generate this
% file.
% \begin{verbatim}
%  \file{hpitr.ins}{\from{hpitr.dtx}{ins}}% not needed
% \end{verbatim}\vskip-\baselineskip
%    \begin{macrocode}
  \file{hpitr.cls}{\from{hpitr.dtx}{class}}%
  \file{hpitr-manual.ltx}{\from{hpitr.dtx}{doc,manual}}%
  \file{hpitr.ltx}{\from{hpitr.dtx}{doc}}%
  \nopreamble\nopostamble
  \file{example-single.tex}{\from{hpitr.dtx}{example,single}}%
  \file{example-singlea.tex}{\from{hpitr.dtx}{example,single,article}}%
  \file{example-proceedings.tex}{\from{hpitr.dtx}{example,proceedings}}%
  \file{example-inproceedings.tex}{\from{hpitr.dtx}{example,inproceedings,article}}%
  \file{README.txt}{\from{hpitr.dtx}{README}}%
}%
%    \end{macrocode}
% After file generation, wie use shell escapes (aka \verb|\write18| feature) to
% create \File{hpitr-manual.pdf}, the manual, and \File{hpitr.pdf}, the full
% documentation.
%    \begin{macrocode}
\ifToplevel{%
  \Msg{* \space\space done.}
}

\immediate\write18{cp README.txt README || copy README.txt README}
\immediate\write18{lualatex -interaction=nonstopmode hpitr.ltx}
\immediate\write18{mkindex hpitr}
\immediate\write18{lualatex -interaction=nonstopmode hpitr.ltx}
\immediate\write18{mkindex hpitr}
\immediate\write18{lualatex -interaction=nonstopmode hpitr.ltx}

\immediate\write18{lualatex -interaction=nonstopmode hpitr-manual.ltx}
\immediate\write18{mkindex hpitr-manual}
\immediate\write18{lualatex -interaction=nonstopmode hpitr-manual.ltx}
\immediate\write18{mkindex hpitr-manual}
\immediate\write18{lualatex -interaction=nonstopmode hpitr-manual.ltx}


\immediate\write18{lualatex -interaction=nonstopmode example-inproceedings}
\immediate\write18{biber example-inproceedings}
\immediate\write18{lualatex -interaction=nonstopmode example-inproceedings}
\immediate\write18{lualatex -interaction=nonstopmode example-inproceedings}



\ifToplevel{%
  \Msg{* \space\space done.}
  \Msg{*}
  \Msg{* You may install all the files now.}
  \Msg{*}
  \Msg{********************************************************************}
}
%    \end{macrocode}
% At docstrip, this concludes the run.
%    \begin{macrocode}
\csname endinput\endcsname
%    \end{macrocode}
% \iffalse meta-comment
%</dtx|ins>
% \fi^^A meta-comment
%^^A ==========================================================================
%^^A ==========================================================================
%^^A ==========================================================================
% \iffalse meta-comment
%<*class>
% \fi^^A meta-comment
%
% \subsection{The Tech Report Class}
%
%
% \subsubsection{Preparation}
%
%    \begin{macrocode}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Basic tools
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{etoolbox}
\RequirePackage{scrbase}[2013/12/19]


%%
%% Id and error
%%
\edef\TR@ClassName{\@currname}
\def\TR@warn{\ClassWarning{\TR@ClassName}}
\def\TR@info{\ClassInfo{\TR@ClassName}}
\def\TR@error{\ClassError{\TR@ClassName}}
\newcommand*\TR@fonterror{\TR@error{%
    Old font commands are not to be used}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Conditional statements
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{ifthen,ifdraft,ifxetex,ifluatex}

%    \end{macrocode}
% 
% \subsubsection{Initialization}
%    \begin{macrocode}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Options
%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% reach into the gut of latex' kernel to push back global vars
\newcommand*\@pushback@classoption[1]{%
  \xdef\@classoptionslist{%
    \ifx\@classoptionslist\@empty\else\@classoptionslist,\fi
    #1}%
}


\newcommand*{\TR@NowButAtEndOfClass}{\AtEndOfClass}
\AtEndOfClass{\let\TR@NowButAtEndOfClass\@firstofone}

% from scrkbase

\DefineFamily{hpitr}
\def\TRFamily{\DefineFamilyMember{hpitr}}
\TRFamily%


\newcommand*{\TRKey}[1][.\@currname.\@currext]{%
  \DefineFamilyKey[#1]{hpitr}%
}
\newcommand*{\TRExecuteOptions}[1][.\@currname.\@currext]{%
  \FamilyExecuteOptions[#1]{hpitr}%
}
\newcommand*{\TRoptions}{\FamilyOptions{hpitr}}
\newcommand*{\AfterTRoptions}{}
\let\AfterTRoptions\AtEndOfFamilyOptions
\newcommand*{\TRoption}{\FamilyOption{hpitr}}

\newcommand*{\TRnewif}{\TRFamily\FamilyBoolKey{hpitr}}
\newcommand*{\TRsetif}{\FamilySetBool{hpitr}}
\newcommand*{\TRnewnumc}{\TRFamily\FamilyNumericalKey{hpitr}}
\newcommand*{\TRsetnumc}{\FamilySetNumerical{hpitr}}

\newcommand*{\TRnewifStd}[1]{%
  \newbool{TR@#1}
  \TRnewif{#1}{TR@#1}}

\newcommand*{\TR@curropt}{}
\newcommand*{\TRStdOption}[3][]{%
  \let\TR@curropt\CurrentOption
  \DeclareOption{#2}{
    #1%
    \TRExecuteOptions{#3}}
  \let\CurrentOption\TR@curropt
}

\providebool{@draft}
\newbool{TR@fulldraft}
\TRKey{draft}[true]{%
  \TRsetif{draft}{@draft}{#1}%
  \ifx\FamilyKeyState\FamilyKeyStateProcessed
    \boolfalse{TR@fulldraft}
  \else
    \ifstr{#1}{full}{%
      \booltrue{@draft}
      \booltrue{TR@fulldraft}
    }{}
  \fi
  \AfterTRoptions{
    \ifthenelse{\boolean{@draft}}{
      \@pushback@classoption{draft}
      \ifthenelse{\not\boolean{TR@fulldraft}}{
        \PassOptionsToPackage{draft=false}{scrlayer-scrpage}
        \PassOptionsToPackage{final}{listings}
%    \end{macrocode}
% \changes{v0.3a}{2014/08/08}{Require grffile for non-trivial file names}
%    For non-fulldraft to work with grffile, we unconditionally use the
%    graphics internal draft boolean.
%    \begin{macrocode}
        \AtBeginDocument{\Gin@draftfalse}
      }{}
    }{}
  }
}
\TRStdOption{final}{draft=false}
\TRStdOption{draft}{draft=true}


%% name of the base class
\providecommand*\TR@BaseClass{\@empty}

%% proceedings?
\newbool{TR@proceedings}
\newbool{TR@inproceedings}
\newbool{TR@contribtools}
\newbool{TR@chapters}
\booltrue{TR@chapters}
%    \end{macrocode}
% \begin{option}{chapterbib}
%    \begin{macrocode}
\TRnewifStd{chapterbib}
\TRStdOption{chapterbib}{chapterbib=true}
%    \end{macrocode}
% \end{option}
%
% \begin{option}{copyrightmark}
%   \changes{v1.1}{2015/02/13}{Optionalize copyright mark} %
%   Provide an option to not include a copyright information in the pdf
%   metadata.
%    \begin{macrocode}
\TRnewifStd{copyrightmark}
\TRStdOption{copyrightmark}{copyrightmark=true}
\TRStdOption{nocopyrightmark}{copyrightmark=false}
%    \end{macrocode}
% \end{option}
%
% \begin{option}{trtype}
%    \begin{macrocode}
\TRKey{trtype}{
  \TRsetnumc{trtype}{@tempa}{%
    {singlearticle}{0},{article}{0},%
    {singlereport}{1},{report}{1},%
    {proceedings}{2},%
    {collection}{3},%
    {inproceedings}{4}%
  }{#1}
  \ifcase \@tempa\relax
    \renewcommand*\TR@BaseClass{scrartcl}
    \boolfalse{TR@proceedings}
    \boolfalse{TR@chapters}
    \boolfalse{TR@contribtools}
  \or
    \renewcommand*\TR@BaseClass{scrreprt}
    \boolfalse{TR@proceedings}
    \booltrue{TR@chapters}
    \boolfalse{TR@contribtools}
  \or
    \renewcommand*\TR@BaseClass{scrbook}
    \booltrue{TR@proceedings}
    \booltrue{TR@contribtools}
    \booltrue{TR@chapters}
    \booltrue{TR@chapterbib}
  \or
    \renewcommand*\TR@BaseClass{scrbook}
    \boolfalse{TR@proceedings}
    \booltrue{TR@contribtools}
    \booltrue{TR@chapters}
  \or
    \renewcommand*\TR@BaseClass{scrartcl}
    \booltrue{TR@proceedings}
    \booltrue{TR@contribtools}
    \boolfalse{TR@chapters}
    \boolfalse{TR@chapterbib}
    \booltrue{TR@inproceedings}
    \AtBeginDocument{%
      \booltrue{TR@firsttitleseen}%
      \clearheadinfo%
      }
  \fi
}
%    \end{macrocode}
% \end{option}
% \begin{option}{single}
% \begin{option}{singlereport}
% \begin{option}{singlearticle}
% \begin{option}{proceedings}
% \begin{option}{inproceedings}
% \begin{option}{collection}
%    \begin{macrocode}
\TRStdOption{single}{trtype=singlereport}
\TRStdOption{singlereport}{trtype=singlereport}
\TRStdOption{singlearticle}{trtype=singlearticle}
\TRStdOption{proceedings}{trtype=proceedings}
\TRStdOption{inproceedings}{trtype=inproceedings}
\TRStdOption{collection}{trtype=collection}
%    \end{macrocode}
% \end{option}
% \end{option}
% \end{option}
% \end{option}
% \end{option}
% \end{option}
%    \begin{macrocode}

\TRnewifStd{inproceedingspagenumbers}


\TRnewifStd{todotools}
\TRnewifStd{egiecomma}

%% execute the standard options
\TRExecuteOptions{
  trtype=singlereport,%
  copyrightmark=true,%
}

\FamilyProcessOptions{hpitr}\relax


%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Load base class file
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\LoadClass{\TR@BaseClass}


%%
%% early stuff
%%
\ifthenelse{\boolean{xetex} \or \boolean{luatex}}{}{%
  \RequirePackage[utf8]{inputenc}
}

%    \end{macrocode}
%
% Set basic paper and typearea options
%    \begin{macrocode}
\KOMAoptions{
  twocolumn=false,
  fontsize=11pt,
  footinclude=false,
  headinclude=false,
}
\KOMAoptions{%
  pagesize=auto,
  paper=a4,
  DIV=9,
  twoside=semi,
}
%    \end{macrocode}
%
% Adjust the text block to exhibit a \(\phi\) ratio (golden ratio).
% \mbox{}
% \changes{v1.1}{2015/02/13}{golden ratio textblock}
%    \begin{macrocode}
\areaset[current]{\textwidth}{1.61803399\textwidth}

\AtEndPreamble{\recalctypearea}
%    \end{macrocode}
%
%    \begin{macrocode}
\ifthenelse{\boolean{TR@proceedings}\AND\boolean{TR@chapters}}{
  \KOMAoption{open}{right}
}{}
%
% Fixes
%
%
\RequirePackage{fixltx2e}[2014/06/10]
\RequirePackage{scrhack}

\PassOptionsToPackage{log-declarations=false}{xparse}
\RequirePackage{expl3}[2011/09/05]
\RequirePackage{xparse}
% https://tex.stackexchange.com/questions/185713/fontspec-2-4-and-scale-matchlowercase-causes-error
\ExplSyntaxOn
\cs_if_free:NTF \fp_div:Nn
  {
    \cs_new_protected:Npn \fp_div:Nn #1 #2
      {
        \fp_set:Nn #1 { #1/#2 }
      }
  }{}
\ExplSyntaxOff


%    \end{macrocode}
%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%% Title.
%%
%% No actual title, only a titlepage page when in draft mode.
%%
%% However, we collect the information for the pdf and also for
%% convenience.
% \changes{v0.4}{2014/08/12}{Delay \cs{title}/\cs{author} pdf setting
% to latest point}
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    \begin{macrocode}
\@ifpackagelater{scrbase}{2013/12/19}{%
  \KOMAoption{titlepage}{firstiscover}
}{
  \KOMAoption{titlepage}{yes}
}

\apptocmd{\title}{%
  \AfterPreamble{
    \begingroup
    \appto\pdfstringdefPreHook{\def\\{\space\ignorespaces}}
    \hypersetup{pdftitle={#1}}
    \endgroup}}
{}{%
  \TR@warn{Cannot patch \string\title to set pdftitle}}

\apptocmd{\author}{%
  \AfterPreamble{
    \begingroup
    \appto\pdfstringdefPreHook{\def\and{,\space\ignorespaces}}
    \hypersetup{pdfauthor={#1}}
    \endgroup}
  }
{}{%
  \TR@warn{Cannot patch \string\author to set pdfauthor}}

%    \end{macrocode}
%
% \begin{macro}{\email}
% \mbox{}
%\changes{v0.4}{2014/08/12}{Provide email command based on hyperref}
%    \begin{macrocode}
\providecommand*\email[1]{\href{mailto:#1}{\nolinkurl{#1}}\xspace}
%    \end{macrocode}
% \end{macro}
% \begin{macro}{\hairspace}
% \mbox{}
%\changes{v0.8}{2014/09/26}{Provide hairspace command}
%    \begin{macrocode}
\providecommand*\hairspace{\ifmmode\mskip1mu\else\kern0.08em\fi}
%    \end{macrocode}
% \end{macro}
% \begin{macro}{\eg}
% \begin{macro}{\Eg}
% \begin{macro}{\ie}
% \begin{macro}{\Ie}
% \begin{macro}{\zB}
% \begin{macro}{\ZB}
% \begin{macro}{\dh}
% \begin{macro}{\Dh}
% \mbox{}
%\changes{v0.8}{2014/09/26}{Provide convenient abbreviations}
%    \begin{macrocode}
\ifthenelse{\boolean{TR@egiecomma}}{
  \providecommand*\eg{e.\hairspace{}g.,\xspace}
  \providecommand*\Eg{E.\hairspace{}g.,\xspace}
  \providecommand*\Ie{I.\hairspace{}e.,\xspace}
  \providecommand*\ie{i.\hairspace{}e.,\xspace}
}{
  \providecommand*\eg{e.\hairspace{}g.\xspace}
  \providecommand*\Eg{E.\hairspace{}g.\xspace}
  \providecommand*\Ie{I.\hairspace{}e.\xspace}
  \providecommand*\ie{i.\hairspace{}e.\xspace}
}
\providecommand*\zB{z.\hairspace{}B.\xspace}
\providecommand*\ZB{Z.\hairspace{}B.\xspace}
\providecommand*\dh{d.\hairspace{}h.\xspace}
\providecommand*\Dh{D.\hairspace{}h.\xspace}
%    \end{macrocode}
% \end{macro}
% \end{macro}
% \end{macro}
% \end{macro}
% \end{macro}
% \end{macro}
% \end{macro}
% \end{macro}
%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% Titlepage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \changes{v0.4}{2014/08/12}{If draft-titlepage, set its numbering in Roman
% (for pdftex)}
%    \begin{macrocode}

\ifthenelse{\boolean{@draft}}{
  \AtBeginDocument{
    \setkomafont{author}{\normalfont\normalsize}
    \setkomafont{date}{\normalfont\normalsize}
    \setkomafont{dedication}{\normalfont\normalsize}
    \setkomafont{publishers}{\normalfont\normalsize}
    \setkomafont{subtitle}{\normalfont\small}
    \setkomafont{title}{\normalfont\normalsize}
    \setkomafont{titlehead}{\normalfont\normalsize}
  }
  \pretocmd{\titlepage}{%
    \ifthenelse{\boolean{@mainmatter}}{\pagenumbering{Roman}}{}
    \let\center\flushright%
    \let\endcenter\endflushright%
    \let\huge\normalsize%
  }{}{%
    \TR@warn{Cannot patch \string\maketitle}}
  \apptocmd{\endtitlepage}{%
    \cleardoubleemptypage%
    \ifthenelse{\boolean{@mainmatter}}{%
      \pagenumbering{arabic}}{%
      \pagenumbering{roman}}
      \ifthenelse{\boolean{TR@inproceedingspagenumbers}}{}{%
        \setcounter{page}{5}%
      }
    \relax%
  }{}{%
    \TR@warn{Cannot patch \string\maketitle}}
}{%
  \def\maketitle{%
    \ifthenelse{\boolean{TR@inproceedingspagenumbers}}{}{%
      \setcounter{page}{5}%
    }\relax}
}


\ifthenelse{\boolean{TR@proceedings}\OR\boolean{TR@contribtools}}{
%    \end{macrocode}
%
%
%  Proceedings stuff.
% \begin{macro}{\event}
%% Title of the event
% \changes{v0.4}{2014/08/12}{Delay to latest point for hyperref}
%    \begin{macrocode}
  \newcommand*\event[1]{%
    \gdef\@eventtitle{#1}
    \AfterPreamble{\hypersetup{pdfsubject = {Technical Report: #1}}}
  }
  \def\@eventtitle{%
    \TR@warn{No \string\event\space given}
    \global\cslet{@eventtitle}\@empty}
%    \end{macrocode}
% \end{macro}
% \begin{macro}{\noevent}
% No event: clear it cleanly
% \changes{v0.4}{2014/08/12}{Provide \cs{noevent}}
%    \begin{macrocode}
  \newcommand*\noevent{\gdef\@eventtitle{}}
%% Paper number
  \newcommand{\papernumber}[1]{%
    \def\@papernumber{#1}
    \ifx\@papernumber\empty
    \else
      \renewcommand*{\thepage}{\@papernumber-\arabic{page}}
    \fi
  }
  \let\@papernumber\@empty

%    \end{macrocode}
% \end{macro}
% Collections
% \changes{v0.4}{2014/08/12}{Add facilities to make collections.}
%    \begin{macrocode}
  \RequirePackage{ragged2e,trimspaces}
  \ifthenelse{\boolean{TR@inproceedings}}{}{%
    \AtEndPreamble{%
      \RequirePackage{biblatex}}
    }
%    \end{macrocode}
% Automatically pick up \texttt{preamble.tex} and \texttt{content.tex} for each
% contribution.
%    \begin{macrocode}
  \providecommand\TR@contributions{}
  \newcommand*{\contributions}[1]{%
    \xdef\TR@contributions{#1}%
    \configureContributions%
  }
  \newcommand*{\TR@preamble}[1]{%
      \InputIfFileExists {#1/preamble}{}{}%
      \ifthenelse{\boolean{TR@chapterbib}}{}{%
        \addbibresource{#1/references.bib}
      }}

  \newcommand*{\configureContributions}{%
    \def\doit{}%
    \@for\next:=\TR@contributions\do{%
      \expandafter\edef\expandafter\@tempa\expandafter%
      {\expandafter\trim@spaces\expandafter{\next}}
      \ifx\@empty\@tempa\relax\else%
      \expandafter\appto\expandafter\doit\expandafter%
      {\expandafter\TR@preamble\expandafter{\@tempa}}%
      \fi%
    }%
    \doit{}%
  }
  \newcommand*{\includeContributionContents}{%
    \def\doit{}%
    \@for\next:=\TR@contributions\do{%
      \expandafter\edef\expandafter\@tempa\expandafter%
      {\expandafter\trim@spaces\expandafter{\next}}
      \ifx\@empty\@tempa\else%
      \expandafter\appto\expandafter\doit\expandafter%
      {\expandafter\TR@includedir\expandafter{\@tempa}}%
      \fi%
    }%
    \doit{}%
  }
%    \end{macrocode}
% Include \texttt{content.tex}, make it appear local and pick up bibliography.
% \changes{v1.0a}{2015/02/09}{Fix \cs{input} and \cs{include} to respect \TeX\ paths}
%    \begin{macrocode}
  \newcommand*{\TR@includedir}[1]{%
    \global\let\TR@saved@include\include
    \global\let\TR@saved@input\input
    \gdef\include##1{%
      \IfFileExists{#1/##1}{%
        \TR@saved@include{#1/##1}
      }{%
        \TR@saved@include{##1}}}
    \gdef\input##1{%
      \IfFileExists{#1/##1}{%
        \TR@saved@input{#1/##1}%
      }{%
        \TR@saved@input{##1}}}
    \graphicspath{{#1/}}
    \TR@includedir@{#1}
    \global\let\include\TR@saved@include%
    \global\let\input\TR@saved@input%
  }
  \ifthenelse{\boolean{TR@chapterbib}}{%
    \newcommand*{\TR@includedir@}[1]{%
      \begin{refsection}[#1/references.bib]
        \ifthenelse{\boolean{TR@proceedings}}{%
          \cleardoubleemptypage}{\clearpage}%
        \TR@saved@input{#1/content}%
        \printbibliography[%
          heading=subbibliography, %
          title=\refname, %
        ]%
      \end{refsection}}
  }{%
    \newcommand*{\TR@includedir@}[1]{%
      \ifthenelse{\boolean{TR@proceedings}}{\cleardoubleemptypage}{\clearpage}%
      \TR@saved@input{#1/content}%
    }
  }

%    \end{macrocode}
%
% Support for multiple seperate work titles, portions from llncs.cls
%    \begin{macrocode}
  \def\clearheadinfo{\gdef\@author{No Author Given}%
    \gdef\@title{No Title Given}%
    \gdef\@subtitle{}%
    \gdef\@institute{No Institute Given}%
    \gdef\@group{}%
    \gdef\@organization{}%
    \gdef\@thanks{}%
    \gdef\@email{}%
    \global\let\@titlerunning\@empty% only non-proceedings
  }
  \newkomafont{abstract}{\normalfont\small}


  \def\institute#1{\gdef\@institute{#1}}
  \def\organisation#1{\gdef\@organization{#1}}
  \let\organization\organisation
  \def\group#1{\gdef\@group{#1}}
  \ifcsundef{email}{\newcommand*\email{}}
  \renewcommand*\email[1]{\gdef\@email{#1}}

  \ifthenelse{\boolean{TR@proceedings}}{%
    \newcounter{@inst}
    \newcounter{@auth}
    \newcounter{auco}
    \newbox\headrun
    \newbox\authrun
    \newtoks\authorrunning
    \newtoks\tocauthor
    \newtoks\titlerunning
    \newtoks\toctitle

    \def\institutename{\par\begingroup
      \parskip=\z@
      \parindent=\z@
      \setcounter{@inst}{1}%
      \def\and{\par\stepcounter{@inst}%
        \noindent$^{\the@inst}$\enspace\ignorespaces}%
      \setbox0=\vbox{\def\thanks##1{}\@institute}%
      \ifnum\c@@inst=1\relax
        \gdef\fnnstart{0}%
      \else
        \xdef\fnnstart{\c@@inst}%
        \setcounter{@inst}{1}%
        \noindent$^{\the@inst}$\enspace
      \fi
      \ignorespaces
      \ifx\@organization\@empty\relax%
        \@institute%
      \else%
        \@group \\ \@organization \\ \href{mailto:\@email}{\nolinkurl{\@email}}%
       \fi%
       \par
      \endgroup}

    \def\inst#1{\unskip$^{#1}$}
    \def\fnmsep{\unskip$^,$}

%    \end{macrocode}
% ToC-formatters for title and author, also llncs style (proceedings)
%    \begin{macrocode}
    \def\l@title#1#2{%
      \addpenalty{-\@highpenalty}
      \addvspace\baselineskip
      \@tempdima \z@
      \begingroup
        \parindent \z@ \rightskip \@tocrmarg
        \advance\rightskip by 0pt plus 2cm
        \parfillskip -\rightskip \pretolerance=10000
        \leavevmode \advance\leftskip\@tempdima \hskip -\leftskip
        \begingroup%
          \setlength{\RaggedRightRightskip}{0pt plus 1fil}%
          \RaggedRight%
          #1\nobreak
          \leaders\hbox{$\m@th \mkern \@dotsep mu.\mkern
            \@dotsep mu$}\hfill
          \nobreak\hbox to\@pnumwidth{\hss #2}\par
        \endgroup
        % \penalty\@highpenalty \endgroup
        \penalty10000\endgroup}

      \def\l@author#1#2{%\addpenalty{\@highpenalty}
        \addpenalty{10000}
        \@tempdima=15\p@ %\z@
        \begingroup%
          \parindent \z@ \rightskip \@tocrmarg%
          \advance\rightskip by 0pt plus 2cm%
          \pretolerance=10000
          \leavevmode \advance\leftskip\@tempdima %\hskip -\leftskip
          {\itshape #1\par}
          % \penalty\@highpenalty
          \penalty0\relax
          \endgroup}

    %%% to avoid hyperref warnings
    \providecommand*{\toclevel@author}{999}
    %%% to make title-entry parent of section-entries
    \providecommand*{\toclevel@title}{0}
    \ifthenelse{\boolean{TR@inproceedings}}{%
%    \end{macrocode}
% \changes{v1.1}{2015/02/13}{Record inproceedings information to prc file}
% For a |inproceedings| report, we write crucial information to
% \File{\jobname.prc} to (potentially) pick it up in a |proceedings| run.
%    \begin{macrocode}
      \AtEndDocument{%
        \begingroup
          \def\and{\noexpand\protect\noexpand\and}%
          \addtocontents{prc}{\protect\title{\@title}}
          \addtocontents{prc}{\protect\author{\@author}}
          \addtocontents{prc}{\protect\event{\@eventtitle}}
          \addtocontents{prc}{\protect\papernumber{\@papernumber}}
          \addtocontents{prc}{\protect\file{\jobname.pdf}}
        \endgroup
        \if@filesw
          \expandafter\newwrite\csname tf@prc\endcsname
          \immediate\openout \csname tf@prc\endcsname \jobname.prc\relax
        \fi
      }
    }{}
%%% /if proceedings
  }{}
%    \end{macrocode}
% Patch maketitle to allow one global and multiple local titles.
%    \begin{macrocode}
  \newbool{TR@firsttitleseen}
  \boolfalse{TR@firsttitleseen}

  \let\TR@firsttitle@maketitle\maketitle
  \renewcommand*\maketitle{
    \ifthenelse{\boolean{TR@firsttitleseen}}{%
      \TR@contrib@maketitle%
      }{
        \TR@firsttitle@maketitle%
        \clearheadinfo%
        \booltrue{TR@firsttitleseen}}}
    % we switch to title seen also when people do not use \maketitle
    \apptocmd{\tableofcontents}{\booltrue{TR@firsttitleseen}}{}{%
      \TR@warn{Cannot patch \string\tableofcontents}}

  \let\TR@firsttitle@author\author
  \renewcommand*\author{
    \ifthenelse{\boolean{TR@firsttitleseen}}%
    {\TR@contrib@author}%
    {\TR@firsttitle@author}}

  \AtEndOfClass{
    \let\TR@firsttitle@keywords\keywords
    \renewcommand*\keywords{%
      \ifthenelse{\boolean{TR@firsttitleseen}}%
      {\TR@contrib@keywords}%
      {\TR@firsttitle@keywords}}
  }

  \providecaptionname{english}{\andname}{and}
  \providecaptionname{english}{\lastandname}{\unskip, and}
  \providecaptionname{german}{\andname}{und}
  \providecaptionname{german}{\lastandname}{und}
  \providecaptionname{ngerman}{\andname}{und}
  \providecaptionname{ngerman}{\lastandname}{und}

  \def\TR@authcount#1{\setcounter{auco}{#1}\setcounter{@auth}{1}}
  \pretocmd{\tableofcontents}{%
    \let\authcount\TR@authcount%
    \def\lastand{\ifnum\value{auco}=2\relax
        \unskip{} \andname\
      \else
        \unskip \lastandname\
      \fi}%
    \def\and{\csname\endcsname\stepcounter{@auth}\relax
      \ifnum\value{@auth}=\value{auco}%
        \lastand
      \else
        \unskip,
      \fi}%
  }{}{%
    \TR@warn{Cannot patch \string\tableofcontents}}

  \ifthenelse{\boolean{TR@proceedings}}{%
    \newcommand*\TR@contrib@maketitle{\newpage
      \phantomsection
      \ifthenelse{\boolean{TR@chapters}}{%
        \refstepcounter{chapter}%
      }{}
      \stepcounter{section}%
      \setcounter{section}{0}%
      \setcounter{subsection}{0}%
      \setcounter{figure}{0}
      \setcounter{table}{0}
      \setcounter{equation}{0}
      \setcounter{footnote}{0}%
      \begingroup
      \parindent=\z@
      \renewcommand\thefootnote{\@fnsymbol\c@footnote}%
      \newpage
      \global\@topnum\z@   % Prevents figures from going at top of page.
      \TR@contrib@@maketitle
      \ifthenelse{\boolean{TR@chapters}}{%
        \thispagestyle{\chapterpagestyle}%
      }{%
        \thispagestyle{empty}%
      }
      \@thanks
      \def\\{\unskip\ \ignorespaces}\def\inst##1{\unskip{}}%
      \def\thanks##1{\unskip{}}\def\fnmsep{\unskip}%
      \if!\the\toctitle!\addcontentsline{toc}{title}{\@title}\else
        \addcontentsline{toc}{title}{\the\toctitle}\fi
      \if!\the\titlerunning!\else
        \edef\@title{\the\titlerunning}%
      \fi
      \ifx\@author\empty\relax%
        \xdef\@runninghead{\ignorespaces\@title}
      \else
        \if!\the\tocauthor!\relax
          {\def\and{\noexpand\protect\noexpand\and}%
            \protected@xdef\toc@uthor{\@author}}%
        \else
          \def\\{\noexpand\protect\noexpand\newline}%
          \protected@xdef\scratch{\the\tocauthor}%
          \protected@xdef\toc@uthor{\scratch}%
        \fi
        \addtocontents{toc}{\noexpand\protect\noexpand\authcount{\the\c@auco}}%
        \addcontentsline{toc}{author}{\toc@uthor}%

        \if!\the\authorrunning!
          \value{@inst}=\value{@auth}%
          \setcounter{@auth}{1}%
        \else
          \edef\@author{\the\authorrunning}%
        \fi
%
        \gdef\@runninghead{\unskip\ignorespaces\@author: \@title}
      \fi

      \global\setbox\authrun=\hbox{\usekomafont{pagehead}\@author}%
      \global\setbox\headrun=\hbox{\usekomafont{pagehead}\@runninghead}%
      \ifdim\wd\headrun>\hsize
        \TR@warn{Title and author names too long for running head. Please supply
          a shorter form with \string\titlerunning\space and
          \string\authorrunning\space prior to \string\maketitle}%
        \xdef\@runninghead{Authors/Title Suppressed Due to Excessive Length}%
      \fi
      \xdef\@runninghead{\copy\headrun}
      \xdef\@author{\copy\authrun}
      \ifthenelse{\boolean{TR@chapters}}{%
        \addchapmark{\@runninghead}%
      }{%
        \xdef\TR@titlemark{\@runninghead}%
        \xdef\TR@authormark{\@author}%
      }%
      \endgroup
      \setcounter{footnote}{\fnnstart}%
      \clearheadinfo%
      \relax%
      \ignorespaces}

    \newcommand*\TR@contrib@@maketitle{\newpage
      \def\lastand{\ifnum\value{@inst}=2\relax
          \unskip{} \andname\
         \else
           \unskip \lastandname\
         \fi}%
       \def\and{\stepcounter{@auth}\relax
         \ifnum\value{@auth}=\value{@inst}%
           \lastand
         \else
           \unskip,
         \fi}%
       \begin{center}%
         \let\newline\\
         {\Large \bfseries\boldmath
           \pretolerance=10000
           \@title \par}\vskip .8cm
         \if!\@subtitle!\else {\large \bfseries\boldmath
           \vskip -.65cm
           \pretolerance=10000
           \@subtitle \par}\vskip .8cm\fi
         \setbox0=\vbox{\setcounter{@auth}{1}\def\and{\stepcounter{@auth}}%
           \def\thanks##1{}\@author}%
         \global\value{@inst}=\value{@auth}%
         \global\value{auco}=\value{@auth}%
         \setcounter{@auth}{1}%
         {\lineskip .5em
           \noindent\ignorespaces
           \@author\vskip.35cm}
         {\small\institutename}
       \end{center}%
     }

     % \providecaptionname{english}{\keywordname}{Keywords}
     % \providecaptionname{german,ngerman}{\keywordname}{Schlagworte}
     \newcommand*\TR@contrib@author[1]{\gdef\@author{#1}}
     % \newcommand*{\TR@contrib@keywords}[1]{%
     %   \par\addvspace\baselineskip%
     %   \noindent\keywordname\enspace\ignorespaces#1}%
     \newcommand*\TR@contrib@keywords[1]{}

   \ifthenelse{\boolean{TR@chapters}}{%
     \renewcommand*\thesection{\@arabic\c@section}
     \renewcommand*\thefigure{\@arabic\c@figure}
     \renewcommand*\thetable{\@arabic\c@table}
     \renewcommand*\theequation{\@arabic\c@equation}
     \@addtoreset{equation}{chapter}
     \BeforePackage{hyperref}{%
       \newcommand*\theHequation{\theHsection.\arabic{equation}}%
       \newcommand*\theHchapter    {\arabic{chapter}}%
       \newcommand*\theHfigure     {\theHchapter.\arabic{figure}}%
       \newcommand*\theHtable      {\theHchapter.\arabic{table}}%
       \newcommand*\theHsection    {\theHchapter.\arabic{section}}%
       \newcommand*\theHsubsection   {\theHsection.\arabic{subsection}}
       \newcommand*\theHsubsubsection{\theHsubsection.\arabic{subsubsection}}
       \newcommand*\theHparagraph    {\theHsubsubsection.\arabic{paragraph}}
       \newcommand*\theHsubparagraph {\theHparagraph.\arabic{subparagraph}}
       \newcommand*\theHtheorem      {\theHsection.\arabic{theorem}}
       \newcommand*\theHthm          {\theHsection.\arabic{thm}}
     }
   }{}
  \AtBeginDocument{%
    \setcounter{tocdepth}{0}
  }


  }{%%%% collection
    \let\TR@contrib@author\@gobble
    \let\TR@contrib@keywords\@gobble
    \let\institute\@gobble
    \let\authorrunning\@gobble
    \let\toctitle\@gobble
    \let\tocauthor\@gobble

    \let\@titlerunning\@empty
    \setkomafont{abstract}{\footnotesize\itshape}
    \newcommand*\titlerunning[1]{\gdef\@titlerunning{#1}}
    \newcommand*\TR@contrib@maketitle{%
      \ifcsempty{@titlerunning}{%
        \expandafter\chapter\expandafter{\@title}%
      }{%
        \expandafter\chapter\expandafter[\expandafter\@titlerunning\expandafter]\expandafter{\@title}%
      }
      \edef\@templ{lbl:chaper-\thechapter}%
      \expandafter\label\expandafter{\@templ}%
      \clearheadinfo%
    }
  }

  \AfterPackage{listings}{
    \lstset{numberbychapter=true}}
  \ifthenelse{\boolean{TR@proceedings}}{%
    \AfterPackage{listings}{
      \AtBeginDocument{
        \def\thelstlisting{\@arabic\c@lstlisting}%
        \def\theHlstnumber{\ifx\lst@@caption\@empty \lst@neglisting
                                                 \else \theHlstlisting \fi%
                                                 .\thelstnumber}}}
  }{}

%    \end{macrocode}
% as for title, as for abstract.
%    \begin{macrocode}
    \@ifundefined{abstract}{%
      \newenvironment{abstract}{}{}}{}%
    \renewenvironment{abstract}{%
      \ifthenelse{\boolean{TR@firsttitleseen}}{
        \list{}{%\advance\topsep by0.35cm\relax
          \setlength{\topsep}{0pt}%
          \setlength{\leftmargin}{2em}%
          \setlength{\rightmargin}{\leftmargin}%
          \setlength{\listparindent}{\parindent}%
          \setlength{\itemindent}{\parindent}%
          \setlength{\parsep}{\parskip}%
          \usekomafont{abstract}%
          }\item[]\noindent\ignorespaces%
      }{%
        \TR@error{Proceedings should not have \MessageBreak
          abstracts. Please remove it.}%
      }%
    }%
    {\ifthenelse{\boolean{TR@firsttitleseen}}{\endlist}{}}

  %for compat with swathesis
  \let\supervisors\@gobble
  \let\statements\relax
}{}
%    \end{macrocode}
% \begin{macro}{\keywords}
% \begin{macro}{\test}
% \changes{v0.6}{2014/08/27}{Provide \cs{keywords} command.}
% We provide a \cs{keyword} macro to record keywords for the printed PDF.
% Should there already be one, we patch it like \cs{title} and \cs{author}
%    \begin{macrocode}
\newcommand*\keywords[1]{
  \AfterPreamble{
    \begingroup
    \appto\pdfstringdefPreHook{\def\\{\space\ignorespaces}}
    \hypersetup{pdfkeywords={#1}}
    \endgroup}
}
%    \end{macrocode}
% \end{macro}
% \end{macro}
%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%% Language
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    \begin{macrocode}
\RequirePackage{hyphsubst}
\HyphSubstLet{ngerman}{ngerman-x-latest}
\RequirePackage{babel}
\newcommand*\TR@lang{}\let\TR@lang\@empty

%    \end{macrocode}
% \changes{v0.4}{2014/08/12}{Silence babel+hyperref+shorthands}
%    \begin{macrocode}
\AfterPackage{hyperref}{
  % https://tex.stackexchange.com/questions/193025/babel-hyperref-redefining-shorthand-several-times-per-page
  \patchcmd{\pdfstringdef}
    {\csname HyPsd@babel@}
    {\let\bbl@info\@gobble\csname HyPsd@babel@}
    {}{}
}


%    \end{macrocode}
% extract ISO 639-2 code from babel language name
% \DoNotIndex{\@l,\@L}
%    \begin{macrocode}
{
  \def\@l#1{\equal{\languagename}{#1}}
  \def\@L#1{\gdef\TR@lang{#1}}
\ifthenelse{\@l{afrikaans}}{\@L{af}}{}
\ifthenelse{\@l{bahasa}\OR\@l{indonesian}\OR\@l{indon}\OR%
  \@l{bahasai}\OR\@l{bahasam}\OR\@l{malay}\OR\@l{meyalu}}{\@L{id}}{}
\ifthenelse{\@l{basque}}{\@L{eu}}{}
\ifthenelse{\@l{breton}}{\@L{br}}{}
\ifthenelse{\@l{bulgarian}}{\@L{bg}}{}
\ifthenelse{\@l{catalan}}{\@L{ca}}{}
\ifthenelse{\@l{croatian}}{\@L{hr}}{}
\ifthenelse{\@l{czech}}{\@L{cs}}{}
\ifthenelse{\@l{danish}}{\@L{da}}{}
\ifthenelse{\@l{dutch}}{\@L{nl}}{}
\ifthenelse{\@l{english}\OR\@l{USenglish}\OR\@l{american}\OR%
  \@l{UKenglish}\OR\@l{british}\OR\@l{canadian}\OR%
  \@l{australian}\OR\@l{newzealand}}{\@L{en}}{}
\ifthenelse{\@l{esperanto}}{\@L{eo}}{}
\ifthenelse{\@l{estonian}}{\@L{et}}{}
\ifthenelse{\@l{finnish}}{\@L{fi}}{}
\ifthenelse{%
  \@l{french}\OR\@l{francais}\OR\@l{canadien}\OR\@l{acadian}}{\@L{fr}}{}
\ifthenelse{\@l{galician}}{\@L{gl}}{}
\ifthenelse{\@l{german}\OR\@l{germanb}\OR\@l{ngerman}\OR%
  \@l{ngermanb}\OR\@l{austrian}\OR\@l{naustrian}}{\@L{de}}{}
\ifthenelse{\@l{greek}\OR\@l{polutonikogreek}}{\@L{el}}{}
\ifthenelse{\@l{hebrew}}{\@L{he}}{}
\ifthenelse{\@l{magyar}\OR\@l{hungarian}}{\@L{hu}}{}
\ifthenelse{\@l{icelandic}}{\@L{is}}{}
\ifthenelse{\@l{interlingua}}{\@L{ia}}{}
\ifthenelse{\@l{irish}}{\@L{ga}}{}
\ifthenelse{\@l{italian}}{\@L{it}}{}
\ifthenelse{\@l{latin}}{\@L{la}}{}
\ifthenelse{\@l{samin}}{\@L{se}}{}
\ifthenelse{\@l{norsk}}{\@L{no}}{}
\ifthenelse{\@l{nynorsk}}{\@L{nn}}{}
\ifthenelse{\@l{polish}}{\@L{pl}}{}
\ifthenelse{%
  \@l{portuges}\OR\@l{portuguese}\OR\@l{brazilian}\OR\@l{brazil}}{\@L{pt}}{}
\ifthenelse{\@l{romanian}}{\@L{ro}}{}
\ifthenelse{\@l{russian}}{\@L{ru}}{}
\ifthenelse{\@l{scottish}}{\@L{gd}}{}
}
%    \end{macrocode}
% \subsubsection{Fonts}
% Default font: Serif:  Palatino via \TeX Gyre Pagella\\
% Code Font: Monospace: Source Code Pro (Adobe)\\
% Other emphasis: Sans: Source Sans Pro (Adobe)\\
%    \begin{macrocode}
\ifthenelse{\boolean{luatex}}{%
  \RequirePackage[final]{microtype}[2013/05/23]
}{
  \RequirePackage[final,babel=true]{microtype}[2013/05/23]
}
%
%    \end{macrocode}
%  engine-dependent, eg, encoding, loading.
%    \begin{macrocode}
\RequirePackage[T1]{fontenc}
\ifthenelse{\boolean{luatex} \or \boolean{xetex}}{%
  \RequirePackage{fontspec}[2013/05/20]
}{}
%    \end{macrocode}
% \changes{v1.1b}{2015/03/26}{Font load order}
% Set main font to Palatino, Sans/Mono font to source and math font to Euler.
% Since it takes missing characters from the default text font, we
% unconditionally set up Palatino for T1 encoding, regardless of the actual
% engine/encoding/font-mechanism used.
%    \begin{macrocode}
\RequirePackage[osf,sc]{mathpazo}
\ifthenelse{\boolean{luatex} \or \boolean{xetex}}{%
%    \end{macrocode}
% \changes{v0.4}{2014/08/12}{Load TeX Gyre Pagella before Adobe Source for
% MatchLowercase reference.}
% \changes{v1.1a}{2015/03/24}{Compatibility for older \TeX en}
%    \begin{macrocode}
  \@ifpackagelater{fontspec}{2014/06/01}{%
    \setmainfont{texgyrepagella}[ExternalLocation,%
        Numbers={Proportional,OldStyle},%
        UprightFont= *-regular,%
        BoldFont=*-bold,%
        ItalicFont=*-italic,%
        BoldItalicFont=*-bolditalic,%
        ]
  }{%
    \setmainfont[ExternalLocation,%
        Numbers={Proportional,OldStyle},%
        UprightFont= *-regular,%
        BoldFont=*-bold,%
        ItalicFont=*-italic,%
        BoldItalicFont=*-bolditalic,%
        Ligatures={Common,TeX},%
        ]{texgyrepagella}
  }
  \RequirePackage[scale=MatchLowercase,semibold]{sourcecodepro}
  \RequirePackage[scale=MatchLowercase,semibold,osf]{sourcesanspro}
}{
  \RequirePackage[scale=.9,semibold]{sourcecodepro}
  \RequirePackage[scale=.9,semibold,osf]{sourcesanspro}
}
%    \end{macrocode}
% Palatino is rather heavy and needs a slight increas in leading. 5\,\% is
% plenty.
%    \begin{macrocode}
\linespread{1.05} % a bit more for Palatino
%    \end{macrocode}
% Load Euler virtual math font. It is only available in T1 yet. Note that we
% substitute the |\mathbf| font by Euler's bold math, which is a lot prettier.
%    \begin{macrocode}
\RequirePackage[euler-digits,T1]{eulervm}
\let\mathbf\mathbold
%    \end{macrocode}
% Akin to LNCS, let footnotes be a bit larger
%    \begin{macrocode}
\let\footnotesize\small
%    \end{macrocode}
% \changes{v0.4}{2014/08/12}{Disable tracking=smallcaps in luatex, also. Is broken.}
%    \begin{macrocode}
\ifthenelse{\boolean{xetex}\OR\boolean{luatex}}{
  \microtypesetup{stretch=9,shrink=15,step=3}
}{
  \microtypesetup{stretch=9,shrink=15,step=3,tracking=smallcaps,letterspace=75}
}

\addtokomafont{disposition}{\rmfamily}
\setkomafont{title}{\rmfamily\mdseries}
\addtokomafont{descriptionlabel}{\rmfamily}
\renewcommand*\labelitemii{\normalfont\textendash}
\setfootnoterule{4cc}
\setlength{\skip\footins}{2\baselineskip}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Text companion fonts
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{textcomp}
\RequirePackage{mathcomp}
\RequirePackage{relsize}

%%%
%%% Details
%%%
\KOMAoptions{
  headings=big
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Page breaks
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% no footnote breaks
\interfootnotelinepenalty = 1000

%% avoid widows (Hurenkinder) and orphans (Schusterjungen)
\clubpenalty = \@M
\widowpenalty = \@M

\setlength{\textfloatsep}{2\baselineskip}
\setlength{\floatsep}{\baselineskip}
\setlength{\intextsep}{2\baselineskip}

\AtEndPreamble{
  \frenchspacing
  \raggedbottom
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Headers and footers
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\KOMAoptions{
  headsepline=false,
  footsepline=false,
}
\RequirePackage{scrlayer-scrpage}
\pagestyle{scrheadings}

\ifthenelse{\boolean{TR@chapters}}{
  \renewcommand*\chapterpagestyle{plain.scrheadings}
  \automark[chapter]{chapter}
  \automark*[section]{}
}{
  \ifthenelse{\boolean{TR@inproceedings}}{
    \lehead{\TR@titlemark}
  }{
    \lehead{\@title}
  }
  \automark*[section]{}
}

%    \end{macrocode}
% \changes{v0.4}{2014/08/12}{Fix pagenumber}
%    \begin{macrocode}
\lefoot[]{}\lofoot[]{}
\refoot[]{}\rofoot[]{}
\ifthenelse{\boolean{TR@inproceedings}}{
  \ifthenelse{\boolean{TR@inproceedingspagenumbers}}{
    \cefoot[\pagemark]{\pagemark}
    \cofoot[\pagemark]{\pagemark}
  }{
    \cefoot[]{}
    \cofoot[]{}
  }
}{
  \cefoot[\pagemark]{\pagemark}
  \cofoot[\pagemark]{\pagemark}
}

%%  \ifthenelse{\boolean{TR@proceedings}\OR\boolean{TR@contribtools}}{
%%   \lefoot[\@eventtitle]{\@eventtitle}
%%   \lofoot[\@eventtitle]{\@eventtitle}
%% }{}

 %\setkomafont{pagefoot}{}
\setkomafont{pagehead}{\itshape}
\setkomafont{pageheadfoot}{\normalcolor}
\setkomafont{pagenumber}{\normalfont}
%
%
% Sectioning
%

\ifthenelse{\boolean{TR@chapters}}{
  \renewcommand*{\chapterheadstartvskip}{\vspace*{3\baselineskip}}
  \renewcommand*{\chapterheadendvskip}{\vspace*{2\baselineskip}}
}{}
\@ifpackagelater{scrbase}{2014/10/28}{%
  \AtEndPreamble{%
    \RedeclareSectionCommand[%
      beforeskip=-2\baselineskip,
      afterskip=1\baselineskip]{section}
    \RedeclareSectionCommand[%
      beforeskip=-1\baselineskip,
      afterskip=1\baselineskip]{subsection}
    \RedeclareSectionCommand[%
      beforeskip=-1\baselineskip,
      afterskip=1sp plus -1sp minus 1sp]{subsubsection}
    \RedeclareSectionCommand[%
      beforeskip=1\baselineskip]{paragraph}
    \RedeclareSectionCommand[%
      beforeskip=1\baselineskip]{subparagraph}
  }
}{
  % for sections, not so easy.
  \def\TR@patchw{\TR@warn{Cannot patch sectioning command.\MessageBreak This is
      not severe.}}
  \patchcmd{\section}{-3.5ex \@plus -1ex \@minus -.2ex}{-2\baselineskip}{}{\TR@patchw}
  \patchcmd{\section}{2.3ex \@plus.2ex}{\baselineskip}{}{\TR@patchw}
  \patchcmd{\subsection}{-3.25ex\@plus -1ex \@minus -.2ex}{-\baselineskip}{}{\TR@patchw}
  \patchcmd{\subsection}{1.5ex \@plus .2ex}{\baselineskip}{}{\TR@patchw}
  \patchcmd{\subsubsection}{-3.25ex\@plus -1ex \@minus -.2ex}{-\baselineskip}{}{\TR@patchw}
  \patchcmd{\subsubsection}{1.5ex \@plus .2ex}{1sp \@plus 1sp \@minus 1sp}{}{\TR@patchw}
  \patchcmd{\paragraph}{3.25ex \@plus1ex \@minus .2ex}{\baselineskip}{}{\TR@patchw}
  \patchcmd{\subparagraph}{3.25ex \@plus1ex \@minus .2ex}{\baselineskip}{}{\TR@patchw}
}


%    \end{macrocode}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% PDF links and bookmarks
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \changes{v0.4}{2014/08/12}{Delay hyperreft to the latest possible point.}
%    \begin{macrocode}


\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{%
  final,%
  unicode=true,%
  plainpages=false,%
  pdfpagelabels=true,%
}{hyperref}
\AtEndPreamble{%
  \RequirePackage{hyperref}%
  \RequirePackage{hyperxmp}
}
\AtBeginDocument{%
  \hypersetup{%
    breaklinks=true,
    %pdfborder = 0 0 0,
    bookmarksnumbered = true,
    pdfsubject = {Technical Report},
    pdfkeywords = {},
    pdfcreator = {HPI},
    pdfmetalang = {en},
    pdfproducer = {\TR@ClassName - Technical Reports at the HPI},
    pdflang = {\TR@lang},
    pdfdisplaydoctitle = false,
    pdfpagemode = UseOutlines,
  }
%    \end{macrocode}
%
%   \changes{v1.1}{2015/02/13}{Optionalize copyright mark}%
%   Provide an option to not include a copyright information in the pdf
%   metadata.
%    \begin{macrocode}
  \ifthenelse{\boolean{TR@copyrightmark}}{%
    \hypersetup{pdfcopyright = {Copyright (c) \the\year, HPI}}}{}
%    \end{macrocode}
%    \begin{macrocode}
}
%    \end{macrocode}
%%
%%
%% Table of contents
%%
%% no protrusion there
%% starts on own page.
%    \begin{macrocode}
\RequirePackage{tocbasic}
\setcounter{tocdepth}{1}
\tocbasicautomode
\setuptoc{toc}{noprotrusion}

\AfterPackage{listings}{
  \setuptoc{lol}{noprotrusion}
}

\ifthenelse{\boolean{TR@chapters}}{
  \renewcommand*\raggedchapterentry{\raggedright}
}{}
%    \end{macrocode}
% \subsubsection{Abstract}
% The main abstract for the non-proceedings case, i.\,e., there is exactly one
% abstract in the whole document.
%    \begin{macrocode}
\ifthenelse{\boolean{TR@proceedings}\OR\boolean{TR@contribtools}}{}{
  \renewenvironment{abstract}{%
    \thispagestyle{plain.scrheadings}
    \null\vfil\leavevmode%
    \noindent%
    \ignorespaces%
  }{%
    \par\vfil%
    \cleardoublepage%
  }
}

%    \end{macrocode}
% \subsubsection{Bibliography}
% \changes{v0.4}{2014/08/12}{Provide common biblatex ground}
%    \begin{macrocode}
\PassOptionsToPackage{style=numeric-comp,firstinits=true}{biblatex}
\AfterPackage{biblatex}{
  \setcounter{biburllcpenalty}{7000}
  \setcounter{biburlucpenalty}{8000}
  \ExecuteBibliographyOptions{
    url=false,%
    urldate=iso8601,%
    abbreviate=false,%
    maxnames=20,%
  }
  \PreventPackageFromLoading[\message{%
    ^^J^^JERROR: You tried to load  the cite package that is not compatible
    with biblatex.^^J^^J%
  }]{cite}
}
\AtEndPreamble{
  \@ifpackageloaded{biblatex}{}{
% normal bibtex
    \bibliographystyle{plain}
  }
}

%%%%
%%
%%%
%    \end{macrocode}
% Use references name instead of bibliography throughout
% \changes{v0.4}{2014/08/12}{More robust variand of refname forcing}
%    \begin{macrocode}
\ifthenelse{\boolean{TR@chapters}}{%
  \global\let\@auto@bibname\refname
  \global\let\bibname\refname
  \defcaptionname{ngerman}{\bibname}{\refname}
  \defcaptionname{german}{\bibname}{\refname}
  \defcaptionname{english}{\bibname}{\refname}
}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Math mode
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{amsmath}
\RequirePackage{amssymb}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Tables
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{tabularx}
\RequirePackage{longtable}
\RequirePackage{booktabs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Graphics and Floats
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{graphicx}
%    \end{macrocode}
% \changes{v0.4}{2014/08/12}{Require grffile for non-trivial file names}
%    \begin{macrocode}
\RequirePackage{grffile}

\AtEndPreamble{
  \@ifpackageloaded{float}{}{% mock float
    \providecommand*\floatname[2]{\@namedef{fname@#1}{#2}}
    \providecommand*\floatplacement[2]{\@namedef{fps@#1}{#2}}
    \floatplacement{figure}{htbp}
    \floatplacement{table}{htp}
  }
  \setlength{\abovecaptionskip}{.5\baselineskip}
  \setlength{\belowcaptionskip}{.5\baselineskip}
}

\AfterPackage{float}{
% disable [H]
  \def\@float@HH#1{%
    \TR@error{The [H] specifier for floats is forbidden for\MessageBreak
      the hpitr class.}}
  \floatstyle{komabelow}
}

\setcapindent{1em}
\addtokomafont{captionlabel}{\bfseries}
\PassOptionsToPackage{ruled}{algorithm2e}

\providecommand*\TR@listingfont{}
\ifthenelse{\boolean{xetex}}{%
  \newcommand*\TRlistingfont[1]{\gdef\TR@listingfont{#1\addfontfeature{Mapping=}}}%
}{%
  \ifthenelse{\boolean{luatex}}{%
    \newcommand*\TRlistingfont[1]{\gdef\TR@listingfont{#1\addfontfeature{RawFeature={-tlig;-trep}}}}%
  }{
    \newcommand*\TRlistingfont[1]{\gdef\TR@listingfont{#1}}}
}{}
\TRlistingfont{\ttfamily\small}

\AfterPackage{verbatim}{
  \renewcommand*\verbatim@font{\TR@listingfont}
}
\AfterPackage{listings}{
  \AtEndPreamble{
    \lstset{%
      basicstyle=\TR@listingfont,
      floatplacement=htbp,
      captionpos=t,
      abovecaptionskip=.5\baselineskip,
      belowcaptionskip=.5\baselineskip,
      upquote=true,
      showstringspaces=false,
      inputencoding=utf8,
    }
  }
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Color
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{color}
\RequirePackage[table,svgnames,dvipsnames]{xcolor}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% include PDF Documents
%% with more than 1 page
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ifthenelse{\boolean{TR@proceedings}}{
  \RequirePackage{pdfpages}
  \ifthenelse{\boolean{xetex}}{}{\pdfinclusioncopyfonts = 1}
  \includepdfset{pagecommand={\thispagestyle{plain.scrheadings}}}
}{}



% %%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %% Comments and Todo help
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ifthenelse{\boolean{TR@todotools}}{%
  \RequirePackage[obeyDraft,colorinlistoftodos]{todonotes}
  \newcommand*\todosec{\par\noindent\todo[inline]}
  \newcommand*\secmissing{\par\noindent\todo[color=red,inline,size=\Large]}
  \newcommand\todolist[2]{%
    \par\noindent%
    \todo[inline,color={red!100!green!50},caption={#1}]{%
      \begin{minipage}{\linewidth}%
        \begin{itemize}
          #2%
        \end{itemize}
      \end{minipage}
    }%
  }
  \newcommand\todoauthor[2][\empty]{
    \expandafter\newcommand\csname #2\endcsname[2][\empty]{%
      \todo[color=#1,##1]{#2: ##2}}}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%%  Draft Stuff
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ifthenelse{\boolean{@draft}}{%
  \RequirePackage{blindtext}
  \errorcontextlines=999
  \RequirePackage{eso-pic}
  \newkomafont{draftline}{\small\sffamily}
  \newsavebox{\TR@draftPageLine}
  \AddToShipoutPicture{%
    \AtPageUpperLeft{%
      \raisebox{-\height}[\height][0pt]{\usebox{\TR@draftPageLine}}}%
    \AtPageLowerLeft{%
      \raisebox{\depth}[\height][0pt]{\usebox{\TR@draftPageLine}}}%
  }
  \AddToShipoutPicture{
    \begingroup
    \setlength{\@tempdima}{.5pt}%
    \setlength{\@tempdimb}{\dimexpr\paperwidth-1.75pt\relax}%
    \setlength{\@tempdimc}{\dimexpr\paperheight-1.5pt\relax}%
    \thicklines%
    \put(\LenToUnit{\@tempdima},\LenToUnit{\@tempdima}){%
      \framebox(\LenToUnit{\@tempdimb},\LenToUnit{\@tempdimc}){}}%
    \endgroup
  }
  \AtBeginDocument{
    \hypersetup{
      colorlinks = true,
      linkcolor=MidnightBlue,%
      citecolor=MidnightBlue,%
      urlcolor=MidnightBlue,%
    }
    \def\TR@draftInfo{%
      {\usekomafont{draftline}
      Draft Draft Draft%
      \hspace*{4cm}\today\hspace*{4cm}%
      Draft Draft Draft%
    }}
    \sbox{\TR@draftPageLine}{%
      \colorbox{black!10}{%
        % enlarge box vertically by 1/6 lines
        \raisebox{0pt}%
        [\dimexpr .166\baselineskip + \height]%
        [\dimexpr .166\baselineskip + \depth]{%
          \makebox[\paperwidth]{\color{black!50}\TR@draftInfo}}}}
  }
%    \end{macrocode}
% \changes{v0.3a}{2014/08/08}{Fix listoftodos, only to appear with todotools}
%    \begin{macrocode}
  \ifthenelse{\boolean{TR@todotools}}{
    \AtEndDocument{\listoftodos}}{}
}{
  \let\blindtext\relax
  \let\Blindtext\relax
  \let\blinddocument\relax
  \let\Blinddocument\relax
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Show the page layout
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\RequirePackage{showframe}
% \if@showlayout
%         \RequirePackage{layout}
%         \AtEndDocument{%
%                 \clearpage
%                 \layout
%         }
% \fiifthenelse{\boolean{xetex} \or \boolean{luatex}}{}{%
% }



\PreventPackageFromLoading[%
\message{%
  ^^J^^JERROR: You tried to load a package that is not to be used with this class.^^J^^J}]{%
%
% Disallowed
%
% Layout
  geometry,a4,a4wide,%
% Fonts
  mathptmx,helvet,courier,newtxtext,newtxmath,fourier,%
%
  fancyhdr,%
%
% Not to use.
%
% Fonts / encoding
  ae,aecompl,zefonts,times,mathptm,pslatex,palatino,mathpple,%
  utopia,euler,%
  isolatin,umlaut,t1enc,%
% Graphics
  epsf,psfig,epsfig,subfig,subfigure%
% Outdated
  fancyheadings,scrpage,caption2,glossary,SIstyle,SIunits,%
% Typography
  doublespace%
}

\csgappto{bf}{\TR@fonterror}
\csgappto{it}{\TR@fonterror}
\csgappto{sc}{\TR@fonterror}
\csgappto{rm}{\TR@fonterror}
\csgappto{sc}{\TR@fonterror}
\csgappto{sf}{\TR@fonterror}
\csgappto{sl}{\TR@fonterror}
\csgappto{tt}{\TR@fonterror}

%% Warn about global use of sloppy
\let\TR@sloppy\sloppy
\patchcmd{\sloppypar}{\sloppy}{\TR@sloppy}{}{}
\patchcmd{\@arrayparboxrestore}{\sloppy}{\TR@sloppy}{}{}
\patchcmd{\thebibliography}{\sloppy}{\TR@sloppy}{}{}
%    \end{macrocode}
% \changes{v0.9b}{2014/11/28}{Whitelist \cs{sloppy} in the \File{caption} package}
%    \begin{macrocode}
\AfterPackage{caption}{
  \patchcmd{\caption@boxrestore@mini}{\sloppy}{\TR@sloppy}{}{}
  \patchcmd{\caption@boxrestore}{\sloppy}{\TR@sloppy}{}{}
}
\def\sloppy{\TR@warn{You should not use \string\sloppy. \MessageBreak
Instead, use a sloppypar, when necessary:\MessageBreak
\MessageBreak
\string\begin{sloppypar}\MessageBreak
\space\space...\MessageBreak
\string\end{sloppypar}}%
\TR@sloppy}



%%%%%%% Set counter to 5 (or v), respectively (See above)

\ifthenelse{\boolean{TR@inproceedingspagenumbers}}{}{%
  \setcounter{page}{5}
}
\ifcsdef{frontmatter}{
  \apptocmd{\frontmatter}{%
    \ifthenelse{\boolean{TR@inproceedingspagenumbers}}{}{%
      \setcounter{page}{5}%
    }%
  }{}{\TR@warn{Cannot patch \string\frontmatter}}
}{}


\RequirePackage{xspace}
\RequirePackage{csquotes}
\ifthenelse{\boolean{luatex}\OR\boolean{xetex}}{
  %% http://tex.stackexchange.com/a/16995
  \DeclareUTFcharacter[\UTFencname]{x201C}{\grqq}
  \DeclareUTFcharacter[\UTFencname]{x201E}{\glqq}
}{}
\AtEndPreamble{\RequirePackage{siunitx}}
\AfterPackage{siunitx}{%
  \sisetup{
    binary-units,
    detect-all,
    free-standing-units,
    space-before-unit,
    use-xspace,
    unit-optional-argument,
    parse-units = false,
  }
  \AtEndPreamble{
    \@ifpackageloaded{pgf}{
      \SendSettingsToPgf
    }
    \addto\extrasgerman{\sisetup{locale = DE}}
    \addto\extrasngerman{\sisetup{locale = DE}}
    \addto\extrasenglish{\sisetup{locale = US}}
  }
}

%    \end{macrocode}
% \iffalse meta-comment
%</class>
% \fi^^A meta-comment
%
% \subsection{The Examples}
% \label{sec:The-Examples-and-the-Manual}
% \iffalse meta-comment
%<*example>
% \fi^^A meta-comment
%    \begin{macrocode}
\documentclass[%
  english,%
  todotools=true,%
%<proceedings>  trtype=proceedings%
%<inproceedings>  trtype=inproceedings%
%<single&article>  trtype=singlearticle%
%<single&!article>  trtype=singlereport,draft%
]{hpitr}
\usepackage[backend=biber]{biblatex}
\usepackage{blindtext}
\usepackage{threeparttable}
\usepackage{listings}
%
% Pseudo-code example
%
\usepackage{algpseudocode}
\DeclareNewTOC[name=Algorithm,
  type=algorithm,
  atbegin=\KOMAoptions{captions=above},
  float]{alg}

\rowcolors*{2}{lightgray!25}{}

\begin{filecontents}{example.bib}
@article{953350,
  Address = {New York, NY, USA},
  Author = {Nassi, I. and Shneiderman, B.},
  Doi = {10.1145/953349.953350},
  Issn = {0362-1340},
  Journal = {SIGPLAN Not.},
  Number = {8},
  Pages = {12--26},
  Publisher = {ACM},
  Title = {Flowchart techniques for structured programming},
  Volume = {8},
  Year = {1973}}
\end{filecontents}
\addbibresource{example.bib}

\begin{document}

% \authorrunning{Author}
% \titlerunning{The importance of work}
\title{The importance of why and how to do work}
\subtitle{An imaginary paper to showcase a document}
\author{Anna Author\and Bert Betatester}
\keywords{paper, showcase, lorem ipsum}
% \institute{%
%   Hasso-Plattner-Institut, Potsdam\\
%   \email{\{firstname.lastname\}@student.hpi.uni-potsdam.de}
% }
% \supervisors{%
%   Prof.\,Dr.\,William Withaname\and%
%  Dr.\,John Doe}
\maketitle

%<*!proceedings>
\begin{abstract}
  Hello, here is some text without a meaning. This text should show what a
  printed text will look like at this place. If you read this text, you will
  get no information. Really? Is there no information? Is there a difference
  between this text and some nonsense like “Huardest gefburn”? Kjift – not at
  all! A blind text like this gives you information about the selected font,
  how the letters are written and an impression of the look. This text should
  contain all letters of the alphabet and it should be written in of the
  original language. There is no need for special content, but the length of
  words should match the language.
\end{abstract}
%</!proceedings>
%<proceedings>\frontmatter
%<!article>\tableofcontents
%<!article>\lstlistoflistings
%<proceedings>\mainmatter

%<*!article>
\Blinddocument

\chapter{Other examples}
\label{cha:other}

Other sectioning examples, including listings and tables.

%</!article>
\section{Introduction}
\label{sec:introduction}

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.\todo{cite}

\subsection{Contributions}
\label{sec:contributions}


Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.

\section{Context}
\label{sec:context}

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.

\todosec{Is that redundant?}

\subsection{Background}
\label{sec:background}

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.

\section{Problem}
\label{sec:problem}

\secmissing{The Main Problem}
Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.~\cite{953350}



\subsection{Specific Problem}
\label{sec:specific-problem}

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.

\section{Solution}
\label{sec:solution}

\todolist{anton}{
\item Put A onto B
\item Put B into C
\item Pull D from C
}%
Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.

\subsection{Specific Solution}
\label{sec:specific-solution}

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.


\begin{table}
  \centering
  \caption{Different Animals, different values}
  \label{tab:different}
  \begin{tabular}{@{}llSs@{}}
    \hiderowcolors
    \toprule
    \multicolumn{2}{c}{Item}\\ \cmidrule(r){1-2}
    Animal    & Description & {Value}   & Unit\\
    \midrule
    Gnat      & per gram    &    2.3456 & \dB                       \\
              & each        &    1.2e-3 & \metre\squared\per\second \\
    Gnu       & stuffed     &       e3  & \kilo\hertz               \\
    Emu       & stuffed     &   90.473  & \percent                  \\
    Armadillo & frozen      & 5642.5    & \mega\byte                \\
    \bottomrule
    \showrowcolors
  \end{tabular}
\end{table}

\section{Implementation}
\label{sec:implementation}

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.

\begin{figure}
  \centering
  \setlength{\unitlength}{.01in}%{.025in}
  \begin{picture}(200,75)
    \put(0,25){\vector(1,0){200}}
    \put(25,0){\vector(0,1){75}}
    \put(75,22){\line(0,1){6}}
    \put(125,22){\line(0,1){6}}
    \put(22,50){\line(1,0){6}}
    \thicklines
    \put(25,25){\line(1,0){50}}
    \put(75,50){\line(1,0){50}}
    \put(125,25){\line(1,0){72}}
    \put(17,50){\makebox(0,0){$1$}}
    \put(75,13){\makebox(0,0)[b]{$\pi$}}
    \put(125,13){\makebox(0,0)[b]{$2\pi$}}
    \put(195,13){\makebox(0,0)[b]{$t$}}
    \put(175,60){\makebox(0,0){$g(t)$}}
  \end{picture}
  \caption{A test figure}
  \label{fig:test}
\end{figure}

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.

\missingfigure{Make a overview sketch of the whole system}

\subsection{Minor Detail}
\label{sec:detail}

\begin{algorithm}
\caption{The Bellman-Kalaba algorithm}
\begin{algorithmic}[1]
\Procedure {BellmanKalaba}{$G$, $u$, $l$, $p$}
\ForAll {$v \in V(G)$}
\State $l(v) \leftarrow \infty$
\EndFor
\State $l(u) \leftarrow 0$
\Repeat
\For {$i \leftarrow 1, n$}
\State $min \leftarrow l(v_i)$
\For {$j \leftarrow 1, n$}
\If {$min > e(v_i, v_j) + l(v_j)$}
\State $min \leftarrow e(v_i, v_j)$\State $p(i) \leftarrow v_j$
\EndIf
$+l(v_j)$
\EndFor
\State $l’(i) \leftarrow min$
\EndFor
\State $changed \leftarrow l \not= l’$
\State $l \leftarrow l’$
\Until{$\neg changed$}
\EndProcedure
\Statex
\Procedure {FindPathBK}{$v$, $u$, $p$}
\If {$v = u$}
\State \textbf{Write} $v$
\Else
\State $w \leftarrow v$
\While {$w \not= u$}
\State \textbf{Write} $w$
\State $w \leftarrow p(w)$
\EndWhile
\EndIf
\EndProcedure
\end{algorithmic}
\end{algorithm}

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.

\section{Evaluation}
\label{sec:evaluation}

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.

\lstset{language=Java}
\begin{lstlisting}[label=lst:example,caption={An example code snippet},float,numbers=left]
class HelloWorldApp {
    public static void main(String[] args) {
        System.out.println("Hello World!"); // Display the string.
    }
}
\end{lstlisting}


We have nice things: some code in \autoref{lst:example} and some information
in \autoref{tbl:things}.

\[\nabla \cdot \mathbf{E} = \frac{\rho}{\varepsilon_0}\]
\[\nabla \cdot \mathbf{B} = 0\]
\[\nabla \times \mathbf{E} = -\frac {\partial \mathbf{B}}{\partial t}\]
\[\nabla \times \mathbf{B} = \mu_0 \mathbf{J} + \mu_0\varepsilon_0  \frac{\partial \mathbf{E}}{\partial t}\]


\subsection{Threats to Valitidy}
\label{sec:threats-valitidy}


Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.

\section{Related Work}
\label{sec:related-work}

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.


\section{Conclusion}
\label{sec:conclusion}

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.




\begin{table}
  \centering
  \begin{threeparttable}
    \caption{Differences between things projected and things achieved}
    \label{tbl:things}
    \begin{tabular}{>{}p{.4\linewidth}@{}c}
      \toprule
      Part           & done \\
      \midrule
      Title          & yes  \\
      Abstract       & no   \\
      Intro          & yes  \\
      \midrule
      \multicolumn{2}{c}{Rest is not entirely true} \\
      \midrule
      Context        & yes  \\
      Problem        & no\tnote{a} \\
      Solution       & yes  \\
      Implementation & yes  \\
      Evaluation     & no   \\
      Related Work   & no   \\
      Conclusion     & yes  \\
      \bottomrule
    \end{tabular}
    \begin{tablenotes}
    \item [a] Just a few things missing
    \end{tablenotes}
  \end{threeparttable}
\end{table}

We have nice things: some code in \autoref{lst:example} and some information
in \autoref{tbl:things}.

Hello, here is some text without a meaning. This text should show what a
printed text will look like at this place. If you read this text, you will get
no information. Really? Is there no information? Is there a difference between
this text and some nonsense like “Huardest gefburn”? Kjift – not at all! A
blind text like this gives you information about the selected font, how the
letters are written and an impression of the look. This text should contain all
letters of the alphabet and it should be written in of the original language.
There is no need for special content, but the length of words should match the
language.


\printbibliography

%%% Local Variables: 
%%% mode: latex
%%% End: 
\end{document}
%    \end{macrocode}
%
% \iffalse meta-comment
%</example>
% \fi^^A meta-comment
%
%
% \subsection{The Manual}
% \label{sec:manual}
%
% Load standard \LaTeX documentation class, passing all options to it
% but use |scrartcl| instead of |article|.
%    \begin{macrocode}
%<*doc|manual|README>
%<*!README>
\RequirePackage{scrlfile}
\ReplaceClass{article}{scrartcl}
%    \end{macrocode}
%
% Should we need \textsc{url}s, we want them to break nicely, also on hyphens.
% Since either \texttt{ltxdoc} or \texttt{hypdoc} loads the \texttt{url}
% package, we pass this option early.
%    \begin{macrocode}
\PassOptionsToPackage{hyphens}{url}
%    \end{macrocode}
% Load the \texttt{ltxdoc} class (patched to subsequently load a KOMAScript
% class). We set a calculating \texttt{DIV}\footnote{see KOMAScript guide} and
% the two-column option, since we eventually end up kind-of two-column anyways.
% However, we do this not by the normal means so we force |\onecolumn| once the
% document commences.
%    \begin{macrocode}
\documentclass{ltxdoc}
\KOMAoptions{%
  paper=a4,
  fontsize=9pt,
  pagesize,twocolumn=true,DIV=calc,mpinclude=true}
\AtBeginDocument{\onecolumn}


\usepackage{ifpdf,ifxetex,etoolbox,xspace}
\usepackage{color}
\usepackage[x11names,dvipsnames,svgnames]{xcolor}

\patchcmd{\section}{-3.5ex \@plus -1ex \@minus -.2ex}{-2\baselineskip}{}{}
\patchcmd{\section}{2.3ex \@plus.2ex}{\baselineskip}{}{}
\patchcmd{\subsection}{-3.25ex\@plus -1ex \@minus -.2ex}{-\baselineskip}{}{}
\patchcmd{\subsection}{1.5ex \@plus .2ex}{\baselineskip}{}{}
\patchcmd{\subsubsection}{-3.25ex\@plus -1ex \@minus -.2ex}{-\baselineskip}{}{}
\patchcmd{\subsubsection}{1.5ex \@plus .2ex}{1sp \@plus 1sp \@minus 1sp}{}{}
\patchcmd{\paragraph}{3.25ex \@plus1ex \@minus .2ex}{\baselineskip}{}{}
\patchcmd{\subparagraph}{3.25ex \@plus1ex \@minus .2ex}{\baselineskip}{}{}


%    \end{macrocode}
% Customize the display of our code:
% \begin{itemize}
% \item Use two columns at index
% \item Outdent a bit
% \item Make line numbers gray
% \item Print all code in monospaced font
% \end{itemize}
%    \begin{macrocode}
\setcounter{IndexColumns}{2}
\MacroTopsep=0pt
\MacrocodeTopsep=3pt
\setlength\MacroIndent{0pt}
\setlength{\columnsep}{18pt}
\providecommand*\theCodelineNo{%
  \normalfont\sffamily\color{black!50}\scriptsize%
  \arabic{CodelineNo}\ }
\let\dmsize\scriptsize
\def\dm#1{{\dmsize\textrm{\textit{\textcolor{DarkBlue}{#1}}}}\xspace}

\providecommand*\MacroFont{\ttfamily\small}
\providecommand*\AltMacroFont{\ttfamily\footnotesize}
\providecommand*\EnvName{environment}
\providecommand*\EnvsName{environments}
\providecommand*\OptionName{option}
\providecommand*\OptionsName{options}

 % tob be overridden by hypdoc
\renewcommand*\PrintMacroName[1]{\strut\MacroFont\string #1}
\renewcommand*\PrintDescribeMacro[1]{\strut \dm{c} \MacroFont #1\ }
\makeatletter
\renewcommand*\PrintEnvName[1]{%
  \HD@target%
  \strut \MacroFont #1\ }
\renewcommand*\PrintDescribeEnv[1]{%
  \HD@target%
  \strut \dm{e} \MacroFont #1\ }
\newcommand*\PrintDescribeOption[1]{%
  \HD@target%
  \strut \dm{o} \MacroFont #1\ }
\newcommand*\PrintOptionName[1]{%
  \HD@target%
  \strut \MacroFont #1\ }
\makeatother
\newcommand*\PrintDescribeValue[2]{%
  \strut \dm{v} \MacroFont{\scriptsize #1=}#2\ }


\usepackage{hypdoc}

\makeatletter
\def\macro{\begingroup
  \catcode`\\12
  \MakePrivateLetters \m@cro@{0}}
\def\environment{\begingroup
  \catcode`\\12
  \MakePrivateLetters \m@cro@{1}}
\def\option{\begingroup
  \catcode`\\12
  \MakePrivateLetters \m@cro@{2}}

%^^A \def\endmacro{}
\long\def\m@cro@#1#2{\endgroup \topsep\MacroTopsep \trivlist
  \edef\saved@macroname{\string#2}%
  \def\makelabel##1{\llap{##1}}%
  \if@inlabel
    \let\@tempa\@empty \count@\macro@cnt
    \loop \ifnum\count@>\z@
      \edef\@tempa{\@tempa\hbox{\strut}}\advance\count@\m@ne 
    \repeat
    \edef\makelabel##1{\llap{\vtop to\baselineskip
        {\@tempa\hbox{##1}\vss}}}%
    % \def\makelabel##1{\\##1}
    \advance \macro@cnt \@ne
  \else \macro@cnt\@ne \fi
  \edef\@tempa{\noexpand\item[%
    \ifcase #1
      \noexpand\PrintMacroName
    \or
      \noexpand\PrintEnvName
    \or
      \noexpand\PrintOptionName
    \fi
    {\string#2}]%
  }%
  \@tempa
  \global\advance\c@CodelineNo\@ne
  \ifcase #1
    \SpecialMainIndex{#2}\nobreak
    \DoNotIndex{#2}%
  \or
    \SpecialMainEnvIndex{#2}\nobreak
  \or
    \SpecialMainOptionIndex{#2}\nobreak
  \fi
  \global\advance\c@CodelineNo\m@ne
  \ignorespaces}
\let\endoption\endmacro

% Defining new main index commands
\newcommand*{\SpecialMainIndex@Type}[3]{%
  \@bsphack\special@index{%
    #1\actualchar
    {\string\ttfamily\space#1}
    (\string #2)%
    \encapchar main}%
  \special@index{%
    #3:\levelchar{%
      \string\ttfamily\space#1}\encapchar
    main}\@esphack}
\renewcommand*{\SpecialMainEnvIndex}[1]{%
  \SpecialMainIndex@Type{#1}{\EnvName}{\EnvsName}}
\newcommand*{\SpecialMainOptionIndex}[1]{%
  \SpecialMainIndex@Type{#1}{\OptionName}{\OptionsName}}



% Defining new usage index commands
\newcommand*{\SpecialIndex@Type}[3]{%
  \@bsphack
  \begingroup
    \HD@target
    \let\HDorg@encapchar\encapchar
    \edef\encapchar usage{%
      \HDorg@encapchar hdclindex{\the\c@HD@hypercount}{usage}%
    }%
  \index{#1\actualchar{\protect\ttfamily#1}
    (#2)\encapchar usage}%
  \index{#3:\levelchar{\protect\ttfamily#1}\encapchar
    usage}\endgroup\@esphack}
\renewcommand{\SpecialEnvIndex}[1]{%
  \SpecialIndex@Type{#1}{\EnvName}{\EnvsName}}
\newcommand*{\SpecialOptionIndex}[1]{%
  \SpecialMainIndex@Type{#1}{\OptionName}{\OptionsName}}

\newbool{TR@indescribe}
\def\TR@describe@table@begin{%
  \ifvmode\else\par\fi\small\addvspace{2\baselineskip}%
  \vspace*{-\baselineskip}%
  \vspace{\z@ plus \baselineskip}%
  \noindent%
  \hspace{-1em}
  \tabular{|l|}\hline\ignorespaces}
\def\TR@describe@table@end{%
  \\%
  \hline\endtabular\nobreak\par\nobreak%
  \vspace{1.5\baselineskip}\nobreak\vspace{-\baselineskip}\nobreak%
  \vspace{0pt minus .5\baselineskip}\nobreak%
}

% Define new describe commands
\newcommand*{\newDescribe}[1]{%
  \csgdef{Describe#1}{%
    \leavevmode\@bsphack\begingroup\MakePrivateLetters%
    \csuse{Describe@#1}}%
  \csgdef{Describe@#1}##1{%
    \endgroup%
    \ifthenelse{\boolean{TR@indescribe}}{}{\TR@describe@table@begin}%
    \noindent\mbox{\csuse{PrintDescribe#1}{##1}}%
    \ifthenelse{\boolean{TR@indescribe}}{}{\TR@describe@table@end}%
    \csuse{Special#1Index}{##1}\@esphack\ignorespaces}%
}
\newDescribe{Env}
\newDescribe{Option}
\def\Describe@Macro#1{\endgroup%
  \ifthenelse{\boolean{TR@indescribe}}{}{\TR@describe@table@begin}%
  \noindent\mbox{\PrintDescribeMacro{#1}}%
  \ifthenelse{\boolean{TR@indescribe}}{}{\TR@describe@table@end}%
  \SpecialUsageIndex{#1}\@esphack\ignorespaces}

\def\DescribeValue{\leavevmode\@bsphack\begingroup%
  \MakePrivateLetters\Describe@Value}
\def\Describe@Value#1#2{%
    \endgroup%
    \ifthenelse{\boolean{TR@indescribe}}{}{\TR@describe@table@begin}%
    \noindent\mbox{\PrintDescribeValue{#1}{#2}}%
    \ifthenelse{\boolean{TR@indescribe}}{}{\TR@describe@table@end}%
    \@esphack\ignorespaces}%

\newenvironment{Describe}{%
  \ifthenelse{\boolean{TR@indescribe}}{\error{Do not nest Describe}}{}%
  \booltrue{TR@indescribe}%
  \TR@describe@table@begin%
}{%
  \boolfalse{TR@indescribe}%
  \TR@describe@table@end%
  \nopagebreak%
  \ignorespaces%
}
\makeatother


%    \end{macrocode}
% Packages we want for hyper-reference support, a tight table of contents,
% fonts (EB~Garamond and the Adobe Source family), and finally a package for
% parallel typesetting, among others.
%    \begin{macrocode}
\usepackage[tocflat,toctextentriesindented]{tocstyle}%
\usetocstyle{nopagecolumn}
\usepackage[toc]{multitoc}
\usepackage{fixltx2e}
\usepackage{relsize}
\usepackage{fontspec}
\usepackage{microtype}
\newfontfeature{Microtype}{protrusion=default;expansion=default;}
%^^A\usepackage[scale=MatchLowercase]{ebgaramond}
\setmainfont{EB Garamond}[%
Scale=MatchLowercase,%
Numbers=OldStyle,%
Ligatures=TeX%
]
\newcommand*\cfrac[2]{{\addfontfeature{Fractions=On} #1/#2}}
\usepackage{unicode-math}
\setmathfont{EB Garamond}
\usepackage[scale=MatchLowercase,semibold,osf]{sourcesanspro}
\usepackage[scale=MatchLowercase,semibold]{sourcecodepro}
\RequirePackage{hyphsubst}
\HyphSubstLet{ngerman}{ngerman-x-latest}
\usepackage[main=english,ngerman]{babel}
\babeltags{german=ngerman,english=english}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{ragged2e}
\usepackage{hologo}
\usepackage{array}
\usepackage[binary-units]{siunitx}
\DeclareSIUnit[number-unit-product = {}] \pt{pt}
\DeclareSIUnit[number-unit-product = {}] \pc{pc}
\usepackage{listings}
%^^A\definecolor{Blue1}{rgb}{0,0,1}
\lstdefinelanguage[hpitr]{TeX}[AlLaTeX]{TeX}{%
  deletetexcs={title,author},
  morekeywords={abstract},
  moretexcs={chapter},
  moretexcs=[2]{title,author,subtitle,keywords,maketitle},
  moretexcs=[3]{addbibresource,printbibliography},
}
\lstset{%
  basicstyle={\color{darkgray}\small\ttfamily},%
  language={[hpitr]TeX},%
  columns=fullflexible,%
  stringstyle=\color{RosyBrown},%
  texcsstyle=*{\color{Purple}\mdseries},%
  texcsstyle=*[2]{\color{Blue1}},%
  texcsstyle=*[3]{\color{ForestGreen}},%
  % identifierstyle=\color{Blue1},%
  commentstyle={\color{FireBrick}},%
  escapechar=`,%
}
\usepackage{threeparttable}
\usepackage{paracol}
\marginparthreshold{0}
%    \end{macrocode}
% We predominantly want to use the set serif font for all sectioning. We also
% want a good text area.
%    \begin{macrocode}
\setkomafont{subtitle}{\usekomafont{title}\LARGE\em}
\addtokomafont{disposition}{\rmfamily}

\providecommand*\generalshape{\upshape}
\setkomafont{title}{\rmfamily\mdseries}
\addtokomafont{subject}{\mdseries}
\setkomafont{disposition}{\rmfamily\mdseries\generalshape}
\addtokomafont{footnote}{\generalshape}
\addtokomafont{paragraph}{\em}
\addtokomafont{descriptionlabel}{\mdseries}
\addtokomafont{captionlabel}{\mdseries}
\renewcommand*\labelitemii{\normalfont\textendash}


\renewenvironment{abstract}%
{\list{}{\listparindent 1em%
    \advance\leftmargin 4em\relax
    \itemindent    \listparindent
    \rightmargin   \leftmargin
    \parsep        0pt plus 1pt\relax
  }%
  \item\relax}
{\endlist}

\setfootnoterule{4cc}
\hypersetup{%
    colorlinks=true,   %% true for printout
    linkcolor=MidnightBlue,%
    citecolor=MidnightBlue,%
    urlcolor=MidnightBlue,%
}



\raggedbottom
\recalctypearea
%    \end{macrocode}
% For debugging only
%    \begin{macrocode}
% \usepackage{showframe}
% \errorcontextlines=999
%    \end{macrocode}
% A semantic macro for files and paths. (\emph{Note:} cannot be a |\let|, or
% else |hypdoc| is upset.)
%    \begin{macrocode}
\newcommand*{\File}{}\def\File{\texttt}

\providecommand*\LuaTeX{\hologo{LuaTeX}}
\providecommand*\pdfTeX{\hologo{pdfTeX}}
\providecommand*\XeTeX{\hologo{XeTeX}}
\AtBeginDocument{\addcontentsonly{toc}{0}}
\footnotelayout{m}

\newenvironment{eng}[1][]%
  {\begin{leftcolumn*}[#1]\begin{english}%
        \let\generalshape\upshape%
      }%
  {\end{english}\end{leftcolumn*}}
\newenvironment*{ger}%
{\begin{rightcolumn}
 \begin{german}%
   \let\generalshape\em%
   \let\origtheHsection\theHsection%
   \def\theHsection{ignore.\origtheHsection}%
   % \let\section\origSect%
   % \let\subsection\origSubSect%
   % \let\subsubsection\origSubSubSect%
   % \let\paragraph\origPar%
   \em}%
{\end{german}%
 \end{rightcolumn}}

\renewcommand*\listoftocname{%
  \textenglish{Contents} / \emph{\textgerman{Inhalt}}}
\let\contentsname\mycontentsname

\newcommand\remark[1]{%
  \unskip\par\vspace{\baselineskip}
  \noindent\framebox[\linewidth]{%
    \parbox{\linewidth}{\centering
    #1%
  }}%
  \vspace{\baselineskip}\par%
}
\usepackage{enumitem}
\setlist{%
  noitemsep,%
  partopsep=0pt,%
  topsep=\baselineskip,%
  leftmargin=\parindent}
% \setlist[1]{%
%   leftmargin=0pt%
% }
\setdescription{noitemsep,topsep=\baselineskip,font=\normalfont\scshape,leftmargin=\parindent}
\DeclareRobustCommand\cf[1]{%
cf.\,{#1}
}
\GlossaryPrologue{%
  \section*{\textenglish{Change History} / \emph{\textgerman{Änderungsverlauf}} }}
\IndexPrologue{
\begin{paracol}{2}[\section*{Index}%
  \markboth{Index}{Index}]
\begin{eng}
  Numbers written in italic refer to the page where the corresponding entry is
  described; numbers underlined refer to the code line of the definition;
  numbers in roman refer to the code lines where the entry is used.
\end{eng}\begin{ger}
  Kursive Zahlen bezeichnen die Seite, auf welcher ein Eintrag beschrieben ist;
  unterstrichene Zahlen bezeichnen die Quelltextzeile seine Definition;
  nicht-ausgezeichnete Zahlen beziehen sich auf Quelltextzeilen, wo der Eintrag
  benutzt wird.
\end{ger}
\end{paracol}
}


%<!manual>\CodelineIndex
\RecordChanges
\EnableCrossrefs
%<manual>\OnlyDescription
\GetFileInfo{\jobname.ltx}
\begin{document}
\title{The Class \File{hpitr} for Writing Technical Reports at the
  Hasso~Plattner~Institute\footnote{This is file version \fileversion{} of
    file \File{\filename}.}}
\subtitle{Die Klasse \File{hpitr} zur Erstellung technischer Berichte am
  Hasso-Plattner-Institut}
\author{Tobias Pape %
  \textless\protect\url{tobias.pape@hpi.de}\textgreater}
\date{\fileversion{} \filedate}
\maketitle
\begin{abstract}
%</!README>
%<*!manual>

%<!README>\begin{paracol}{2}[]\begin{eng}
%<!README>This consititutes the \LaTeX\ class to creat technical reports at the 
%<README>This consititutes the LaTeX class to creat technical reports at the 
Plattner Institute, Potsdam in conjunction with the Universitätsverlag
Potsdam. To maintain a unified appearance, this class provides macrotypographic
(like paper size and general layout) and microtypographic (like fonts and their
adjustment) settings.
%<!README>\end{eng}

%<README> ---

%<!README>\begin{ger}
%<!README>Diese \LaTeX-Klasse dient zur Erstellung von technischen Berichten
%<README>Diese LaTeX-Klasse dient zur Erstellung von technischen Berichten
am Hasso-Plattner-Institut, Potsdam, in Zusammenarbeit mit dem
Universitätsverlag Potsdam. Zur Erhaltung eines einheitlichen
Erscheinungsbildes bietet diese Klasses Einstellungen zu Makrotypographie (wie
Papiergröße, allgemeines Layout) und auch zur Detailtypographie (wie
Schriftwahl).
%<!README>\end{ger}\end{paracol}


%</!manual>
% \end{macrocode}
%
% The installation instructions that end up in the README are from the
% \texttt{titlepage.dtx} again.
% \begin{macrocode}
%<*README>

-------------------------------------------------------------------------------
Note: To generate all files, you should simply call

      pdftex -shell-escape hpitr.dtx

If you are using MiKTeX you have to use

     pdftex --enable-write18 hpitr.dtx

to fully enable shell escapes which are also known as \write18 feature.

All ltx files should be installed together with all pdf files at documentation
folder. The sty file together with all def files should be installed at latex
package folder.

But maybe your distributor already distributes a ready for installation
package, so you do not need to create files and copy them yourself.
%</README>
%<*manual>
This manual gives a concise usage guide for the \texttt{hpitr} class, used to
prepare technical reports at the Hasso Plattner Institute, Potsdam
in conjunction with the Universitätsverlag Potsdam. We describe newly
introduced commands and environments and document deviations from what may seem
typical, like non-standard paper size.
%</manual>
%<*!README>
\end{abstract}
%<*manual>
%^^A ==========================================================================
%^^A ==========================================================================
%^^A ==========================================================================
\tableofcontents
\iffalse
TODO:
%%%%%
For conversions from llncs:
Du benutzt die Defintion-umgebung. Die gibts in lncs, aber nicht
sonst. Ich habe sie dir mit amsthm nachgebaut.

\fi

\begin{paracol}{2}
\begin{eng}
\section{Introduction}
\label{sec:intro}
All technical reports the Hasso-Plattner-Institut für Sofwaresystemtechnik (\textsc{hpi})
issues should have a uniform appearance. The \LaTeX{} class \File{hpitr} exists
for this very purpose. Its aim is to ease the work with and on technical
reports of the \textsc{hpi} and ensure their uniformity.

This manual illustrates the means this \LaTeX{} class provides and explains the
necessary constraints.
\end{eng}
\begin{ger}
\section{Einführung}
Alle technischen Berichte, die das Hasso"-Plattner"-Institut für
Sofwaresystemtechnik (\textsc{hpi}) herausgibt sollen ein einheitliches
Erscheinungsbild haben. Zu diesem Zweck existiert diese \LaTeX"=Klasse names
\File{hpitr}. Sie soll die Arbeit an und mit technischen Berichten des
\textsc{hpi} vereinfachen und die Einheitlichkeit sicherstellen.

Im diesem Handbuch werden die Möglichkeiten dieser \LaTeX"=Klasse erläutert
und die notwendigen Einschränkungen erklärt.
\end{ger}
\end{paracol}

\begin{paracol}{2}
\begin{eng}
\subsection{A note on \LaTeX{} elements}
\end{eng}
\begin{ger}
\subsection{Eine Anmerkung zu \LaTeX"=Befehlen}
\end{ger}
\end{paracol}
\begin{Describe}
  \DescribeMacro{command}\\
  \DescribeEnv{environment}\\
  \DescribeOption{option}\\
  \DescribeValue{option}{value}
\end{Describe}
\begingroup \let\dmsize\large
\begin{paracol}{2}
\begin{eng}
To easily find documentation to specific \LaTeX{} elements this class
provides, that location is highlighted by a box like above. Every \LaTeX{}
element is prefixed by its type: command sequences \dm{c}, environments
\dm{e}, class options \dm{o}, and values to class option keys \dm{v}. This
should help navigating in the  manual.
\end{eng}
\begin{ger}
  Zur schnellen Hilfe zu bestimmen \LaTeX"=Befehlen dieser Klasse wird die
  zugehörige Erklärung mit einem Kasten wie oben zusehen markiert. Befehlsarten
  haben dabei eigene Präfixe: Befehle~\dm{c}, Umgebungen~\dm{e},
  \mbox{Klassenoptionen~\dm{o}} und Werte für Klassenoptionen~\dm{v}.
  Das soll die Orientierung im Handbuch erleichtern.
\end{ger}
\end{paracol}
\endgroup


\begin{paracol}{2}
\begin{eng}
\subsection{An Example}
\label{sec:example}
As jump-start, a very minimal but complete \File{hpitr} technical report follows:
\begin{lstlisting}
\documentclass[english,trtype=singlereport]{hpitr}
% Use Biblatex
\usepackage[backend=biber]{biblatex}
\addbibresource{references.bib}

\begin{document}
\title{The importance of why and how to do work}
\subtitle{An imaginary paper}
\author{Anna Author\and Bert Betatester}
\keywords{paper, showcase, lorem ipsum}
\maketitle

\begin{abstract}
  `This “paper”…`
\end{abstract}
\chapter{Introduction}
In computer science~\cite{myref}...
\chapter{...}
...
\printbibliography
\end{document}
\end{lstlisting}
This example sets a \File{hpitr} report that
 \begin{itemize}
 \item is an original report (\lstinline|trtype=singlereport|),
 \item uses Biblatex with \hologo{biber},
 \item and gives all meta-information for title, author, and keywords.
\end{itemize}

Note that by intention, the typical selection of the input encoding
\hbox{(\kern0pt\lstinline|\usepackage[...]{inputenc}|)} is not present in this example. All
files of \File{hpitr} reports are to be written using \textsc{utf-8} encoding. The class
file takes care to select the right input encoding.

\remark{All files of a \File{hpitr} report must be \textsc{utf-8}
encoded.}

\end{eng}
\begin{ger}
\subsection{Ein Beispiel}
Als Starthilfe folg ein minimaler, doch vollständiger Technischer Bericht mit
\File{hpitr}:
\begin{lstlisting}
\documentclass[ngerman,trtype=singlereport]{hpitr}
% Biblatex benutzen
\usepackage[backend=biber]{biblatex}
\addbibresource{references.bib}

\begin{document}
\title{Von der Wichtigkeit der Arbeit und sie zu tun}
\subtitle{Eine imaginäre Abhandlung}
\author{Anna Author\and Bert Betatester}
\keywords{Arbeit, Beispiel, lorem ipsum}
\maketitle

\begin{abstract}
  `Diese „Arbeit“...`
\end{abstract}
\chapter{Einführung}
Die Informatik hat~\cite{myref}...
\chapter{...}
...
\printbibliography
\end{document}
\end{lstlisting}
Dieses Beispiel erzeugt einen \File{hpitr}"=Bericht, der
\begin{itemize}
\item ein eigentlicher Bericht ist (\lstinline|trtype=singlereport|),
\item Biblatex mit \hologo{biber} benutzt,
\item und Metadaten für Titel, Autoren und Schlagwörter
  bereitstellt.
\end{itemize}

Zu beachten ist, dass die eigentlich typische Auswahl der Eingabecodiereung
(\lstinline|\usepackage[...]{inputenc}|) im Beispiel nicht vorhanden ist. Dies
geschieht absichtilich, das alle Dateien eines \File{hpitr}"=Berichts in
\textsc{utf-8}"=Codierung geschrieben werden sollen. Die Klasse sorgt dann für
die korrerte Handhabung.

\remark{Alle Dateien eines \File{hpitr}"=Berichts müssen
  \textsc{utf-8}"=codiert sein.}
\end{ger}
\end{paracol}
%^^A ----------------------------------------
\begin{paracol}{2}
\begin{eng}
\subsection{Running \LaTeX}
\label{sec:running}
\File{hpitr} reports are handed to the publisher \emph{Universitätsverlag
  Potsdam} as \textsc{pdf} files. The \File{hpitr} class support the three
major \TeX{} engines that directly produce \textsc{pdf} files:
\begin{itemize}
\item \pdfTeX{} (exectuable \lstinline[language=bash]|pdflatex|),
\item \LuaTeX{} (exectuable \lstinline[language=bash]|lualatex|), and
\item \XeTeX{} (exectuable \lstinline[language=bash]|xelatex|).
\end{itemize}
For best results, and for best Unicode and \textsc{utf-8} support, the \LuaTeX
engine is recommended. For the same reason, it is recomended to use Biblatex
with the \hologo{biber} engine instead of plain \BibTeX.

A typical \LaTeX{} run for a \File{hpitr} report should look like this:
\begin{lstlisting}[language=bash]
lualatex report
biber report
lualatex report
lualatex report
\end{lstlisting}
This should build the \textsc{pdf} file with all bibliographic information.
\end{eng}
\begin{ger}
\subsection{\LaTeX"=Läufe}
Alle \File{hpitr}"=Berichte werden als \textsc{pdf}"=Dateien an den
Universitätsverlag Potsdam übermittelt. Die Klasse unterstützt daher die drei
verbreiteten \TeX"=Systeme mit direkter \textsc{pdf}"=Ausgabe:
\begin{itemize}
\item \pdfTeX{} (Programmdatei \lstinline[language=bash]|pdflatex|),
\item \LuaTeX{} (Programmdatei \lstinline[language=bash]|lualatex|) und
\item \XeTeX{} (Programmdatei \lstinline[language=bash]|xelatex|).
\end{itemize}
Für beste Ergebnisse und beste Unicode/\textsc{utf-8}"=Untersützung wird das
\LuaTeX"=System empfohlen. Aus gleichen Gründen empfiehlt es sich, Biblatex mit
dem \hologo{biber}"=System statt einfachem \BibTeX\ zu verwenden.

Ein typischer \LaTeX"=Lauf eines \File{hpitr}"=Berichts sollte so aussehen:
\begin{lstlisting}[language=bash]
lualatex report
biber report
lualatex report
lualatex report
\end{lstlisting}
Dies sollte die \textsc{pdf}"=Datei mit Bibliographieinformationen
erzeugen.
\end{ger}
\end{paracol}
%^^A----------------------------------------
\clearpage
\begin{paracol}{2}
\begin{eng}
\section{Report Structure}
\end{eng}
\begin{ger}
\section{Berichtstruktur}
\end{ger}
\end{paracol}

\begin{paracol}{2}
\begin{eng}
\subsection{Types of Reports}
\label{sec:types}
\end{eng}
\begin{ger}
\subsection{Berichtarten}
\end{ger}
\end{paracol}
\DescribeOption{trtype=\meta{type}}
\begin{paracol}{2}
\begin{eng}
This class support the types of technical reports that are common at the HPI.
In essence, there are three variants.
\end{eng}
\begin{ger}
Die Klasse unterstütz die am HPI üblichen Arten von technischen Berichten.
Grob sind das drei Varianten.
\end{ger}
\end{paracol}


\begin{Describe}
  \DescribeValue{trtype}{singlearticle}\\
  \DescribeValue{trtype}{article}\\
  {\color{gray} \DescribeOption{singlearticle}}
\end{Describe}
\begin{paracol}{2}
\begin{eng}
\paragraph{Article-like reports}
\label{sec:art-like}
Reports that are basically similar to conference or journal articles or
extend such articles have an \emph{article-like} character. Their top-level
sectioning element is the \emph{sections}.
\end{eng}
\begin{ger}
\paragraph{Artikelartige Berichte}
Berichte, die im Kern ähnlich zu Tagungs-, Konferenz- oder
Zeitschriftenartikeln sind, oder erweiterte Varianten davon sind, haben
\emph{artikelartigen} Charakter. Ihre höchste Gliederungsebene sind
\emph{Abschnitte}.
\end{ger}
\end{paracol}


\begin{Describe}
\DescribeValue{trtype}{singlereport}\\
\DescribeValue{trtype}{report}\\
{\color{gray} \DescribeOption{single}}\\
{\color{gray} \DescribeOption{singlereport}}
\end{Describe}
\begin{paracol}{2}
\begin{eng}
\paragraph{Original reports}
\label{sec:original-rprt}
Reports that are like monographs (such as theses) or inherently independent
reports are report in the strict sense.\footnote{Not implying that the other
types are inadequate as technical reports, to the contrary!} Their top-level
sectioning element is the \emph{chapter}.

This is the default type if none is given explicitly.
\end{eng}
\begin{ger}
\paragraph{Eigentliche Berichte}
Berichte, die ähnlich zu Monographien (wie Abschlussarbeiten) oder
grundsätzlich eigenständig sind, sind im eigentlichen Sinne
\emph{berichtartig}.\footnote{Das bedeutet nicht, dass die anderen Arten sich
nicht als technische Berichte eignen würden.} Ihre höchste Gliederungsebene sind
\emph{Kapitel}.

Wird keine Berichtart explizit ausgewählt, ist diese hier Standard.
\end{ger}
\end{paracol}


\begin{Describe}
  \DescribeValue{trtype}{collection}\\
  {\color{gray} \DescribeOption{collection}}\\
  \DescribeValue{trtype}{proceedings}\\
  {\color{gray} \DescribeOption{proceedings}}
\end{Describe}
\begin{paracol}{2}
\begin{eng}
\paragraph{Collection-like reports}
\label{sec:coll-like}
Reports comprising several individual contributions are
\emph{collection-like}. This may include conference proceedings, seminar
compilations, or special issues, among others. Their top-level sectioning
element is the \emph{chapter}. Some commands to
manage such collections are provided for convenience.

Note that proceeding use a different formatting for the individual
contributions. They start with their own title, author information, and
abstract, while in normal collections, this information is absent. In normal
collections, all sections are numbered by chapter.
\end{eng}
\begin{ger}
\paragraph{Sammlungsartige Berichte}
Berichte, die sich aus mehreren Einzelbeiträgen zusammensetzen sind
\emph{sammlungsartig}. Dies kann unter anderem Tagungsbände,
Seminarzusammenfassungen oder Sonderbände beinhalten. Ihre höchste
Gliederungsebene sind \emph{Kapitel}. Es gibt einige Befehle die die
Verwaltung von diesen Sammlungen vereinfachen sollen.

Tagungsbände zeichen sich durch eine besondere Formatierung der
Einzelbeiträge aus; jeder Beitrag beginnt im Gegensatz zu normalen Sammlungen
mit eigenem Titel, Autorennennung und Zusammenfassung. In normalen Sammlungen
ordnet sich die Abschnitsnummerierung der Kapitelnummerierung unter.%
\end{ger}
\end{paracol}

\begin{Describe}
\DescribeValue{trtype}{inproceedings}\\
{\color{gray} \DescribeOption{inproceedings}}
\end{Describe}
\begin{paracol}{2}
\begin{eng}
\paragraph{Contributions}
\label{sec:contrib}
The \File{hpitr} class supports an additional report type, \emph{inproceedings}
that is not intended to be published as is. Rather, this type can be used to
produce a \textsc{pdf} version of an individual contribution to a
proceedings-like report for further processing.
\end{eng}
\begin{ger}
\paragraph{Beiträge zu tagungsbandartigen Berichten}
Die \File{hpitr}"=Klasse unterstützt eine uneigentliche Beritchart
\emph{inproceedings}, die nicht eingenständig veröffentlicht werden soll. Sie
ist dafür gedacht, um einen einzelnen Beitrag zu einem tagungsbandartigen
Bericht als \textsc{pdf} zur möglichen Weiterverabeitung vorzubereiten.
\end{ger}
\end{paracol}

\begin{paracol}{2}
\begin{eng}
\subsection{Report Information and Metadata}
\label{sec:metadata}
\end{eng}
\begin{ger}
\subsection{Informationen zum Bericht und Metadaten}
\end{ger}
\end{paracol}
\begin{Describe}
\DescribeMacro{title}\\
\DescribeMacro{subtitle}\\
\DescribeMacro{author}\\
\DescribeMacro{keywords}\\
\DescribeMacro{maketitle}\\
\DescribeEnv{abstract}
\end{Describe}
\begin{paracol}{2}
\begin{eng}
A set of specific information and metadata has to be provided for all reports.
This comprises
\begin{itemize}
\item the title in English and German,
\item all authors' names,
\item keywords in English and German, and
\item abstracts in English and German
\end{itemize}
which have to be provided \emph{in addtition} to the \textsc{pdf} file.


All but the abstracts have to be also present in the \textsc{pdf} metadata. The
\File{hpitr} class takes care of that as long as the common \LaTeX{} commands
are used, i.\,e.\\
\cs{title}\marg{work title}\\
\cs{subtitle}\marg{optional subtitle}\\
\cs{author}\marg{list of authors seperated by \cs{and}}\\
\cs{keywords}\marg{list of comma separated keywords}, and \cs{maketitle} is
used to make them persistent.

Note that \cs{maketitle}, contrary to normal practice, does \emph{not} create a
title page nor will it create a noticeable title on the first page. This is
intentional, as the \emph{actual} title page for \File{hpitr} reports is
provided by the publisher.

However, the abstract, given in the |abstract| environment, is printed. It is
typically the first page for article-like and original reports. Collection-like
reports do not have an abstract but should rather have a dedicated preface or foreword.

Contributions in collection-like reports are treated specially.
\end{eng}
\begin{ger}
Für alle technischen Berichte müssen bestimmte Informationen und Metadaten
bereitgestellt werden; und zwar
\begin{itemize}
\item der Titel auf Deutsch und Englisch,
\item die Namen aller Autoren,
\item Schlagworte auf Deutsch und Englisch,
\item Kurzfassungen auf Deutsch und Englisch.
\end{itemize}
Diese Informationen müssen \emph{zusätzlich} zur \textsc{pdf}"=Datei
bereitgestellt werden.

Abgesehen von den Kurzfassungen müssen alle Informationen auch als
\textsc{pdf}"=Metadaten zur Verfügung stehen. Die \File{hpitr}"=Klasse sorgt
dafür, solange die typischen \LaTeX"=Befehle dafür genutzt werden:\\
\cs{title}\marg{Berichttitel}\\
\cs{subtitle}\marg{optionaler Untertitel}\\
\cs{author}\marg{Liste der Autorennamen, mit \cs{and} getrennt}\\
\cs{keywords}\marg{kommagetrennte Schlagworte}\\
und \cs{maketitle} um diese Informationen ins \textsc{pdf} zu übernehmen.

Im Gegensatz zur üblichen Praxis setzt \cs{maketitle} absichtilch \emph{weder}
Titelseite \emph{noch} Titelkopf auf der ersten Seite, da die
\emph{eigentliche} Titelei durch den Universitätsverlag angefügt wird.

Die Berichtskurzfassung, die in der |abstract|"=Umgebung angegeben wird, wird
jedoch auf jeden Fall mit ausgegeben. Für artikelartige und eigentliche
Berichtie ist dies typischerweise die erste Seite. Sammlungsartige Berichte
sollten keine Kurzfassung sondern eher ein Vorwort haben.

Beiträge in Sammlungsartigen Berichten werden gesondert behandelt.
\end{ger}
\end{paracol}

\begin{Describe}
  {\color{gray}\DescribeMacro{part}}\\
  \DescribeMacro{chapter}\\
  \DescribeMacro{section}\\
  \DescribeMacro{subsection}\\
  \DescribeMacro{subsubsection}\\
  \DescribeMacro{paragraph}\\
  \DescribeMacro{minisec}
\end{Describe}
\begin{paracol}{2}
\begin{eng}
\subsection{Structuring Elements}

The typical \LaTeX\ commands to structure documents are available to
\File{hpitr} reports with only few restrictions.

The command \cs{chapter} is only available to original reports and
colloection-like reports. All kind of reports can use the commands \cs{section}
to \cs{subsubsection} to structure documents, they created numbered sections.
All of these commands exists in starred variants (e.\,g. \cs{section*}) to
create un-numbered structure elements.

The command \cs{paragraph} will always create an unnumbered structure element.
The body text continues right after its title with no line in between.
Ad-hoc sections can be created with the \cs{minisec} command, it will always
create an unnumbered section.

The \cs{part} command should be used only sparingly, in rather long documents.
Longer original or proceedings-like reports may justify the use of parts.

\cs{subparagraph} should not be used.

\subsubsection*{Proceedings-like Reports}

In proceedings-like reports, chapters should only be used outside the
individual contributions as each contribution acts like an article-like report.
Hence \emph{within} individual contributions, only sections and possibly
paragraphs should be used. Appendix and bibliography act like sections and do
not appear on a page of their own. Chapter should be used for general document
parts such as a preface or foreword, closing remarks, or a general
introduction.

\end{eng}
\begin{ger}
\subsection{Strukturelemente}

Die in \LaTeX\ üblichen Strukturierungsbefehle sind auch in
\File{hpitr}"=Berichten mit nur wenigen Einschränkungen nutzbar.

Der \cs{chapter}"=Befehl ist auf eigentliche und sammlunsartige Berichte
beschränkt. Alle Berichtarten stehen die Befehle \cs{section} bis
\cs{subsubsection} zur Verfügung, sie markieren nummerierte Dokumentabschnitte.
Alle diese Befehle existieren in Stern"=Varianten (wie \cs{section*}) um
nicht-nummerierte Dokumentabschnitte zu markieren.

Der Befehl \cs{paragraph} markiert immer einen nicht-nummerierten
Dokumentabschnitt, typischerweise einen Absatz. Der Absatztext beginnt sofort
nach dem Abschnittstitel ohne Leerzeile.
Nicht-nummerierte ad-hoc"=Abschnitte können mittels \cs{minisec} markiert werden.

Der \cs{part}"=Befehl sollte nur selten zum Einsatz kommen. Eigentliche oder
tagungsbandartige längere Berichte können jedoch die Unterteilung in Teile
rechtfertigen.

\cs{subparagraph} sollte nicht benutzt werden.

\subsubsection*{Tagungsbandartige Berichte}

In Tagungsbänden und ähnlichen Berichten sollten Kapitel nur außerhalb der
eigentlichen, eigenständigen Beiträge Verwendung finden, da jeder Beitrag
einzeln wie ein artikelartiger Bericht wirkt. Daher sollten \emph{in} den
Beiträgen nur Abschnitte und ggf. markierte Absätze genutzt werden. Anhang und
Literturverzeichnis verhalten sich wie Abschnitte und stehen nicht allein auf
einer neuen Seite. Kapitel hingegen sollten für allgemeine Dokumentteile wie
Vorworte, Nachworte oder allgemeine Einführungen genutzt werden.

\end{ger}
\end{paracol}
\begin{Describe}
  \DescribeMacro{tableofcontents}\\
  \DescribeMacro{listoffigures}\\
  \DescribeMacro{listoftables}\\
  {\color{gray} \DescribeMacro{listoflistings}\unskip\ldots}
\end{Describe}

\begin{paracol}{2}
\begin{eng}
\subsubsection*{The Table of Contents}

Reports should contain a table of contents (\cs{tableofcontents}) if they are
not article-like. If present, it should be placed \emph{after} the abstract,
foreword, or preface. Hence, those do not show up in the table of contents.

The table of contents may optionally be followed by a list of all figures
(\cs{listoffigures}) or tables (\cs{listoftables}) in the document. Some
packages provide individual lists that may also be used here, e.\,g. the
\File{listings} package provides a \cs{listoflistings}. All those lists should
\emph{not} be listed in the table of contents.

Individual contributions of proceedings-like reports should not have a table of
contents on their own.
\end{eng}
\begin{ger}

\subsubsection*{Das Inhaltsverzeichnis}

Berichte sollten ein Inhaltsverzeichnis (\cs{tableofcontents}) enthalten,
ausgenommen Artikel-artige Berichte. In diesem Fall folgt es auf die
Kurzfassung oder das Vorwort. Diese werden deshalb nicht im Inhaltsverzeichnis
aufgeführt.

Dem Inhaltsverzeichnis können wahlweise ein Abbildungsverzeichnis
(\cs{listoffigures}) oder Tabellenverzeichnis (\cs{listoftables})
folgen. Einige Pakete stellen eigene Verzeichnisse bereit, die an dieser Stelle
stehen können, so zum Beispiel das \File{listings}"=Paket mit
\cs{listoflistings}. All diese Verzeichnisse sollten selbst \emph{nicht} im
Inhaltsverzeichnis aufgeführt werden.

Die einzelnen Beiträge von tagungsbandartigen Berichten sollten selbst kein
eigenes Inhaltsverzeichnis haben.
\end{ger}
\end{paracol}

\begin{paracol}{2}
\begin{eng}
\section{Layout}
\label{sec:general}
The technical reports of the \textsc{hpi} are published both in printed form
and online. To retain a uniform appearance across those media \emph{and}
across all supported report types, all report have to adhere to the same
layout.

\subsection{Page and type area}
\begin{itemize}
\item All text is set in a single column.
\item The paper size is \SI{210}{\mm}\(\times\)\SI{297}{\mm}
  (\textsc{iso}\,216 A4 \emph{aka} \textsc{din}\,A4); the aspect ratio is \(\sqrt{2}\).
\item There should be typically not more than 85 characters per line.
\item The type area aspect ratio is \emph{Φ}, the \emph{golden ratio}. %\symbol{\string"03A6}
\item The margins fulfill the following equations: {\let\V\mathit
  \[ \V{top} < \V{left} \leq \V{right} < \V{bottom} \text{ and } \V{top} : \V{bottom} = 1 : 2 \]
  }
\end{itemize}
To ensure this layout, the class chooses (approximately) the side margins as
{99}\,\si{\pt} or 8\cfrac{1}{4}\,\si{\pc}, the top margin
{66}\,\si{\pt} or 5\cfrac{1}{2}\,\si{\pc}, and the bottom
margin as {135}\,\si{\pt} or
11\cfrac{1}{4}\,\si{\pc}\footnote{about
  \SI{34.9}{\mm}, \SI{23.3}{\mm}, and \SI{47.6}{\mm}, respectively}.

Page numbers are set centered on the page foot.

\remark{The page dimensions, margins, and type area must not be changed.}

\end{eng}
\begin{ger}
\section{Satzeigenschaften}
Technische Berichte des \textsc{hpi} werden sowohl gedruckt als auch
elektronisch verlegt. Um ein einheitliches Erscheinungsbild über alle Medien
und Berichtarten hinweg zu gewährleisten, müssen alle Berichte den gleichen
Satzeigenschaften genügen.

\subsection{Seite und Satzspiegel}
\begin{itemize}
\item Der Satz erfolgt ausschließlich einspaltig.
\item Die Papiergröße ist \SI{210}{\mm}\(\times\)\SI{297}{\mm}
(\textsc{iso}\,216 A4 alias \textsc{din}\,A4) mit einem Seitenverhältnis von \(\sqrt{2}\).
\item Die Zeilenlänge sollte 85 Zeichen nicht überschreiten.
\item Der Satzspiegel steht im goldenen Schnitt \emph{Φ}.
\item Die Stege (Ränder) sollten folgenden Gleichungen genügen:{\let\V\mathrm
  \[ \V{oben} < \V{links} \leq \V{rechts} < \V{unten} \text{ und } \V{oben} : \V{unten} = 1 : 2 \]
  }
\end{itemize}

Um diesen Satzspiegel zu gewährleisten, wählt die Klasse (ungefähr) die
Seitenstege mit {99}\,\si{\pt} oder 8\cfrac{1}{4}\,\si{\pc},
den Kopfsteg mit {66}\,\si{\pt} oder 5\cfrac{1}{2}\,\si{\pc}
und den Fußsteg mit {135}\,\si{\pt} oder
11\cfrac{1}{4}\,\si{\pc}\footnote{circa \SI{34.9}{\mm},
  \SI{23.3}{\mm}, beziehungswiese \SI{47.6}{\mm}}.

Die Paginierung (Seitenzahlen) erfolgt zentriert im Seitenfuß.

\remark{Seitengröße, Stege (Ränder) und Satzspiegel dürfen nicht verändert
werden.}

\end{ger}
\end{paracol}
\begin{paracol}{2}
\begin{eng}
\subsection{Titles, Document Parts, and Page Numbering}
\label{sec:title}

As pointed our earlier, there is no actual title for \File{hpitr} reports, it
is provided by the publisher. Hence, the page number for the first page is
actually 5.

The page numbering defaults to arabic numbers.

\begin{Describe}
  \DescribeMacro{frontmatter}\\
  \DescribeMacro{mainmatter}\\
  \DescribeMacro{backmatter}
\end{Describe}
Only in collection-like reports, a distinction between frontmatter, mainmatter,
and backmatter is possible. The page numbering should be roman lowercase in the
frontmatter and arabic in the main and backmatter. The first page number of the
frontmatter should be v.
\end{eng}
\begin{ger}
\subsection{Titelei, Dokumentteile und Seitennummerierung}

Wie schon beschrieben haben \File{hpitr}"=Berichte keinen eigentlichen Titel;
dieser wird durch den Verlag erstellt. Die erste Seite hat daher die
Seitenzahl~5.

Die Seitennummerierung erfolgt in arabischen Zahlen.

\vspace{4.5\baselineskip}
Nur in sammlungsartigen Berichten ist eine unterscheidung Zwischen Vorder"~,
Haupt"~ und Hinterteil möglich. Im Vorderteil sollte die Seitennummerierung in
römischen Zahlen (Kleinbuchstaben) erfolgen, sonst mit arabischen. Die erste
Seite hat die Seitenzahl v.
\end{ger}
\end{paracol}

\begin{figure*}[tbp]
  \centering
  %\setlength{unitlength}
  \vbox{\hbox to \linewidth{
      \begin{picture}(120,140)
        \makebox(120,140){
        \shortstack{
        \framebox(75,96){{\fontsize{72}{86}\selectfont❦}}\\
        \makebox(96,15)[b]{%
          \color{MidnightBlue}\linethickness{7pt}\line(1,0){96}%
        }}}
      \end{picture}
      \hss
      \begin{picture}(120,140)
        \makebox(120,140){
          \shortstack{
            \makebox(120,96)[lb]{
              \put(10,10){\vector(1,0){100}}
              \put(15,5){\vector(0,1){75}}
              \put(13,50){\line(1,0){6}}
              \put(10,50){\makebox(0,0){\small $1$}}
              \linethickness{12pt}
              \put(30,10){\line(0,1){50}}
              \put(50,10){\line(0,1){22}}
              \put(70,10){\line(0,1){35}}
              \put(90,10){\line(0,1){28}}
            }\\
            \makebox(96,15)[b]{%
              \color{MidnightBlue}\linethickness{7pt}\line(1,0){96}%
            }}}
      \end{picture}
      \hss
      \begin{picture}(120,140)
        \makebox(120,140){
          \shortstack{
            \makebox(96,15)[t]{%
              \color{MidnightBlue}\linethickness{7pt}\line(1,0){96}%
            }\\
            \makebox(110,96)[lt]{
              {\thicklines \put(0,96){\line(1,0){110}}}
              {\thicklines \put(0,0){\line(1,0){110}}}
              \let\mysize\footnotesize
              \put(0,86){\mysize aaaaaa}
              \put(36,86){\mysize zzzzzzzzzzzzzz}
              \put(0,84){\line(1,0){110}}
              \put(0,74){\mysize bbbb}
              \put(36,74){\mysize yyyyyyyyyyyyyyy}
              \put(0,62){\mysize cccc}
              \put(36,62){\mysize xxxxxxxxxxxxxxx}
              \put(36,50){\mysize wwwwwww}
              \put(0,38){\mysize dddddd}
              \put(36,38){\mysize vvvvv}
              \put(36,26){\mysize uuu}
              \put(36,14){\mysize ttttttttttttt}
              \put(0,2){\mysize fff}
              \put(36,2){\mysize sssssssssssssssssssss}
            }}}
      \end{picture}
      \hss
      \begin{picture}(100,140)
        \makebox(100,140){
          \shortstack{
            \makebox(96,15)[t]{%
              \color{MidnightBlue}\linethickness{7pt}\line(1,0){96}%
            }\\
            \makebox(90,100)[lb]{
              \let\mysize\tiny
              \def\lt{\linethickness{5pt}}
              \put(5,96){\linethickness{3pt}\line(1,0){30}}
              \put(0,84){\mysize 1}{
                \put(5,86){\lt\line(1,0){10}}\put(20,86){\lt\line(1,0){25}}
              }
              \put(0,72){\mysize 2}{
                \put(15,74){\lt \line(1,0){15}} \put(35,74){\lt \line(1,0){30}}
                \put(70,74){\lt \line(1,0){20}}
              }
              \put(0,60){\mysize 3}{
                \put(15,60){\lt \line(1,0){10}} \put(30,60){\lt \line(1,0){10}}
                \put(45,60){\lt \line(1,0){30}}
              }
              \put(0,48){\mysize 4}{
                \put(30,50){\lt \line(1,0){30}}}
              \put(0,36){\mysize 5}{
                \put(15,36){\lt \line(1,0){15}}
              }
              \put(0,24){\mysize 6}{
                \put(30,26){\lt \line(1,0){45}}}
              \put(0,12){\mysize 7}{
                \put(15,14){\lt \line (1,0){25}}}
              \put(0, 0){\mysize 8}{
                \put(5,2){\lt \line(1,0){18}}}
            }}}
      \end{picture}
    }}
  \caption{\textenglish{Recommended positions for float captions} /
    \textgerman{\em Empfohlene Positionen für Fließumgebungsbeschriftungen}}
  \label{fig:floats}
\end{figure*}
\begin{paracol}{2}
\begin{eng}
\subsection{Floats}
\label{sec:floats}

All non-text content that warrants its own space and is referenced in the
document is treated as floating content. This includes figures, tables, and
listings to name a few.

Floats may be placed at the point it is given in the source, but may be moved
by \LaTeX\ to the bottom or the top of a page, or to a page of its own. This
moving around is intentional.\\
\emph{Note:} Floats that rely on being placed \emph{exactly} at the point
inserted aren't floats proper and also should not need a caption.\footnote{For
  that reason, the \lstinline|H| specifier of the \File{float} package is not
  available}.

Every float should have a caption, that is placed at the top or the bottom of a
float. Figures---typically graphics, graphs, or charts---are treated as a whole
or read from the bottom left. Their captions therefore are placed \emph{below}
the float. Tables, code listings, algorithm, and similar are read from top to
bottom and might span several pages. Hence, their captions are placed
\emph{above} the float (see \autoref{fig:floats}).

Floats are named by their type numbered within a chapter (original or
collection-like reports) or with a section (article-like reports or
contributions to a proceedings-like report).
\end{eng}
\begin{ger}
\subsection{Fließumgebungen}

Aller nicht-textueller Inhalt, der Platz benötigt und auf den im Dokument
verwiesen wird, wird als "`fließender Inhalt"' behandelt. Dazu zählen z.\,B.
Abbildungen, Tabellen (auch Tafeln) oder Quelltextwiedergaben.

Fließumgebungen können an der Stelle platziert werden, an der sie im Quelltext
auftreten, könen von \LaTeX\ aber auch an den Seitenanfang oder
"~ende oder eine eigene Seite verschoben werden. Dies ist beabsichtigt.\\
\emph{Bemerkung:} Fließumgebungen, die zwingend \emph{exakt} an der Stelle
erscheinen müssen an der sie im Quelltext gegeben sind, sind im eigentlichen
Sinne keine Fließumgebungen und benötigen daher auch keine
Beschriftung.\footnote{Daher ist der \lstinline|H|"=Schalter des
  \File{float}"=Paketes auch nicht verfügbar.}

Jede Fließumgebung sollte an ihrem Anfang oder Ende beschriftet sein.
Abbildungen -- typischerweise Grafiken, Graphen oder Diagramme -- werden als
Ganzes wahrgenommen oder von unten-links gelesen. Sie sollten daher
Bild\emph{unter}schriften erhalten. Tabellen, Quelltextwiedergaben, Algorithmen
oder Ähnliches werden von oben nach unten gelesen und können über mehrere
Seiten gehen. Sie sollten daher \emph{Über}schriften erhalten (siehe \autoref{fig:floats}).

Fließumgebungen werden mit ihrem Typ benamt und innerhalb einens Kapitels (bei
eigentlichen und sammlungsartigen Berichten) oder eines Abschnitts (bei
Artikel-artigen Berichten oder Beiträgen zu einem tagungsbandartigen Bericht)
nummeriert.
\end{ger}
\end{paracol}

\begin{paracol}{2}
\begin{eng}
\section{Microtypography}
\label{sec:micro}

For a consistent appearance, font choice and spacing has to stay stable. The
\File{hpitr} class therefore selects the following fonts, space amounts, and
dimensions.

\subsection{Fonts}
\label{sec:fonts}

The body font family for \File{hpitr} reports is the%
\begin{quotation}{\fontspec{TeX Gyre Pagella}%
  \TeX\ Gyre Pagella%
}\end{quotation}%
family from the GUST
e-foundry\footnote{\url{http://www.gust.org.pl/projects/e-foundry}}, a
digitization of ``{\fontspec{Palatino Linotype} Palatino}'' by Hermann Zapf. It is
set at \SI{12}{\pt} with a line spread of \SI{15.12}{\pt}. For typesetting
source-code--like material, the mono-spaced%
\begin{quotation}{\fontspec{Source Code Pro}[Scale=MatchLowercase]%
    Source Code Pro%
 }\end{quotation}%
family by Adobe can be used. It is automatically scaled to match the body font.
In the same way the sans serif%
\begin{quotation}{\fontspec{Source Sans Pro}[Scale=MatchLowercase]%
    Source Sans Pro%
  }\end{quotation}%
family by Adobe can be used for special emphasis.

Generally, when emphasis is necessary, it is recommended to use \emph{italic}
or \emph{small caps} shapes, and only sparingly resort to a bold font or a sans
serif font, for that matter.

\subsection{Spacing}
\label{sec:spacing}

All spacing is typically handled by the \File{hpitr} class. For reference,
these are the spacings chosen:

\begin{itemize}
\item Paragraphs are set without vertical space but indented by one \emph{em},
 i.\,e. \SI{12}{\pt}. The first paragraph of a chapter or section is not indented.
\item The space before a chapter heading is three empty lines, the space after
  it, two empty lines.
\item The space before a section heading is two empty lines, the space after
  it, one empty line.
\item The space before and after a sub-section heading is one empty line.
\item The space before a sub-sub-section heading is one empty line, no vertical
  space follows.
\item The space before a paragraph heading is one empty line, no vertical or
  horizontal spaces follow.
\item Floats are separated from the body text by two empty lines above and
  below the float.
\item Floats are separated from another by one empty line.
\end{itemize}

\subsection{Float captions}
\label{sec:float-captions}


Captions of floats should be preceded by the un-abbreviated float type, e.\,g.
Figure or Table, the float number and a semi-colon, all in bold font. The
caption that follows should be in normal font.

If the caption is only one line, it should be centered, if it spans multiple
lines, it should be set flush left and all but the first line should be
indented by one \emph{em}, i.\,e. \SI{12}{\pt}.
\end{eng}
\begin{ger}
\section{Detailtypographie}

Für eine konsistente Darstellung, müssen die Wahl von Schrift und Abständen
stabil bleiben. Die \File{hpitr}"=Klasse wählt daher folgende Schriften und
Abstände.

\subsection{Schriften}

Die Hauptschriftart (Brotschrift) für \File{hpitr}"=Berichte ist die%
\begin{quotation}{\fontspec{TeX Gyre Pagella}%
\upshape
  \TeX\ Gyre Pagella%
}\end{quotation}%
der GUST e-foundry, eine Digitalisierung Hermann Zapfs ``{\fontspec{Palatino
    Linotype} Palatino}''. Sie wird mit \SI{12}{\pt} auf einem Zeilenabstand
von \SI{15.12}{\pt} gesetzt. Quelltext"=artige Textteile können in der
dicktengleichen ("`mono-spaced"')%
\begin{quotation}{\fontspec{Source Code Pro}[Scale=MatchLowercase]%
\upshape
    Source Code Pro%
 }\end{quotation}%
von Adobe gesetzt werden. Sie wird automatisch auf die richtige Größe skaliert.
Für spezielle Hervorhebungen kann die serifenlose ("`sans-serif"')
\begin{quotation}{\fontspec{Source Sans Pro}[Scale=MatchLowercase]%
\upshape
    Source Sans Pro%
  }\end{quotation}%
von Adobe in gleicher Weise benutzt werden.

Hervorhebungen sollten generell durch \emph{Kursive} oder \emph{Kapitälchen}
erfolgen; auf serifenlose oder fette Schriften sollte nur sparsam
zurückgegriffen werden.

\subsection{Abstände}

Alle Abstände sind voreingestellt und werden hier nur zur Referenz
wiedergegeben.

\begin{itemize}
\item Absätze werden ohne vertikalen Abstand gesetzt und mit einem Geviert
  (hier \SI{12}{\pt}) eingezogen, es sei denn er folgt einer Überschrift.
\item Kapitelüberschriften werden mit drei Zeilen davor und zwei danach
  abgetrennt.
\item Abschnittsüberschriften werden mit zwei Zeilen davor und einer danach
  abgetrennt.
\item Unterabschnittsüberschriften werden mit je einer Zeile davor und danach
  abgetrennt.
\item Unter"=Unterabschnittsüberschriften werden mit einer Zeile davor
  abgetrennt. Danach folg kein vertikaler Weißraum.
\item Überschriften benamter Absätze werden mit einer Zeile davor abgetrennt.
  Der Text fängt direkt rechts der Überschrift an.
\item Fließumgebungen werden vom Text mit zwei Zeilen abgetrennt.
\item Fließumgebungen werden voneinander mit einer Zeiler abgetrennt.
\end{itemize}

\subsection{Beschriftungen}

Der Beschriftung von Fließumgebungen wir der unverkürzte Name (z.\,B. Abbildung
oder Tabelle), die laufende Fließumgebungsnummer und ein Semikolon
vorangestellt, alles in fetter Schrift. Die eigentliche Beschriftung folgt, in
normaler, nicht"=fetter Schrift.

Ist die gesamte Beschriftung nicht länger als eine Zeile, wird diese zentriert
gesetzt. Mehrzeilige Beschriftungen werden linksbündig gesetzt und bis auf die
erste Zeile mit einem Geviert (hier \SI{12}{\pt}) eingezogen.

\end{ger}
\end{paracol}
\begin{paracol}{2}
\begin{eng}
\subsection*{Additional considerations}
\end{eng}
\begin{ger}
\subsection*{Anderes}
\end{ger}
\end{paracol}

\begin{Describe}
  \DescribeMacro{hairspace}\\
  \DescribeMacro{eg}, %
  \DescribeMacro{Eg}\\
  \DescribeMacro{ie}, %
  \DescribeMacro{Ie}\\
  \DescribeMacro{zB}, %
  \DescribeMacro{ZB}\\
  \DescribeMacro{dh}, %
  \DescribeMacro{Dh}\\
  \DescribeOption{egiecomma}
\end{Describe}

\begin{paracol}{2}
\begin{eng}

\begingroup
\def\hairspace{\ifmmode\mskip1mu\else\kern0.08em\fi}

Note that in abbreviations with periods in either English or German, a
\emph{hairspace} or \emph{half} space follow the period. Thus, the following
should be avoided:
\begin{quotation}
  z.B.\hspace{1em}e.~g.\hspace{1em}i.\hspace{1em}e.
\end{quotation}
but rather be
\begin{quotation}
  z.\hairspace{}B.\hspace{1em}e.\hairspace{}g.\hspace{1em}i.\hairspace{}e.
\end{quotation}

For convenience, commands for i.\hairspace{}e., e.\hairspace{}g.,
d.\hairspace{}h., and z.\hairspace{}B. are provided in initial uppercase and
lowercase form (\cs{ie}, \cs{Ie}, \cs{eg}, \cs{Eg}, \textit{\&c}.). The command
\cs{hairspace} can be used to construct similar commands.

Considering i.\hairspace{}e. and e.\hairspace{}g., practice differs in regard
to whether they should be followed by a comma. The option |egiecomma=true| can
be used to automatically add a comma to their commands. \bigskip

The command \cs{sloppy} is overused and should be refrained from. Rather,
enclose a problematic paragraph by a |sloppypar| environment. 

\remark{The \cs{sloppy} command should not be used}

\endgroup

\end{eng}
\begin{ger}
\begingroup
\def\hairspace{\ifmmode\mskip1mu\else\kern0.08em\fi}

Im Englischen wie im Deutschen folgt in Abkürzungen auf einen Punkt eine
\emph{halbes} (oder kleineres) Leerzeichen. Daher sollte folgendes vermieden
\begin{quotation}
  z.B.\hspace{1em}e.~g.\hspace{1em}i.\hspace{1em}e.
\end{quotation}
und eher so gesetzt werden.
\begin{quotation}
  z.\hairspace{}B.\hspace{1em}e.\hairspace{}g.\hspace{1em}i.\hairspace{}e.
\end{quotation}

Der Einfachheit halber sind daher die Befehle für i.\hairspace{}e.,
e.\hairspace{}g., d.\hairspace{}h. und z.\hairspace{}B. sowohl mit initialen
Groß"~ als auch Kleinbuchstaben vorhanden (\cs{dh}, \cs{Dh}, \cs{zB}, \cs{ZB},
\textit{\&c}.). Der \cs{hairspace}"=Befehl kann für ähnliche Befehle genutzt
werden.

Die Praxis bezüglich einem Komma nach i.\hairspace{}e. und e.\hairspace{}g. ist
uneinheitlich. Die Klassenoption |egiecomma=true| kann daher benutzt werden, um
den entsprechenden Befehlen automatisch ein Komma anzufügen.\bigskip

Der Befehl \cs{sloppy} sollte vermieden werden. Problematische
Stellen können mit der |sloppypar|"=Umgebung besser behandelt werden.

\remark{Der \cs{sloppy}"=Befehl sollte nicht benutzt werden.}

\endgroup

\end{ger}
\end{paracol}

\begin{paracol}{2}
\begin{eng}
\section{Cross-References}
\label{sec:refs}

The \File{hpitr} class supports a certain style of inter- and intra-document references.
\end{eng}
\begin{ger}
\section{Verweise}
Die \File{hpitr}"=Klasse unterstützt einen bestimmten Stil auf andere Quellen
oder innerhalb eines Dokuments zu verweisen.
\end{ger}
\end{paracol}

\DescribeMacro{autoref}
\begin{paracol}{2}
\begin{eng}
\subsection{Intra-document References}

To ease references in-between parts of a document, the \cs{autoref} command can
be used, which produces the following reference texts:

\subsubsection{Reports with chapters}

For reports with chapters (but \emph{not} for proceedings-like reports), the
following reference schema is produced:

\begin{itemize}
\item For chapters: “chapter \(n\)”
\item For section: “section \(n.m\)” where \(n\) is the number of the chapter
\item For sub-section: “section \(n.m.k\)” where \(m\) is the number of the
  section and \(n\) is the number of the chapter. The word subection is not
  used.
\item For sub-sub-section: “section \(n.m.k.l\)” where \(k\) is the number of
  the subsection, \(m\) is the number of the section, and \(n\) is the number
  of the chapter. The word subsubection is not used.
\item For paragraphs: references to paragraphs should be avoided.
\end{itemize}

\subsubsection{Reports without chapters}

For reports without chapters and contributions to proceedings-like reports, the
following reference schema is produced:

\begin{itemize}
\item For section: “section \(n\)”
\item For sub-section: “section \(n.m\)” where \(n\) is the number of the
  section. The word subection is not used.
\item For sub-sub-section: “section \(n.m.k\)” where \(m\) is the number of
  the subsection and \(n\) is the number of the section.
\item For paragraphs: references to paragraphs should be avoided.
\end{itemize}
\bigskip

If possible, the contributions of a proceedings-like report should not
inter-reference each other.

The \cs{autoref} command can also be used to reference to floats.
\end{eng}
\begin{ger}
\subsection{Interne Verweise}

Um Verweise zwischen Dokumentteilen zu erleichtern kann der
\cs{autoref}"=Befehl genutzt werden, der folgende Verweisbeschriftungen
erzeugt:

\subsubsection{Berichte mit Kapiteln}

Für Berichte mit Kapiteln (ausgenommen tagungsbandartige Berichte) wird
folgendes Namensschema verwendet:

\begin{itemize}
\item Für Kapitel: „Kapitel \(n\)“
\item Für Abschnitte: „Abschnitt \(n.m\)“, wobei \(n\) die Kapitelnummer ist.
\item Für Unterabschnitte: „Abschnitt \(n.m.k\)“, wobei \(m\) die
  Abschnittsnummer und \(n\) die Kapitelnummer ist. Das Wort Unterabschnitt
  wird nicht verwendet.
\item Für Unterunterabschnitte: „Abschnitt \(n.m.k.l\)“, wobei \(k\) die
  Unterabschnittsnummer, \(m\) die Abschnittsnummer und \(n\) die Kapitelnummer
  ist. Das Wort Unterunterabschnitt wird nicht verwendet.
\item Benamte Absätze: Verweise auf benamte Absätze sollten vermieden werden.
\end{itemize}
\subsubsection{Berichte ohne Kapitel}

Für Berichte ohne Kapitel und Beiträge zu tagungsbandartigen Berichten  wird
folgendes Namensschema verwendet:

\begin{itemize}
\item Für Abschnitte: „Abschnitt \(n\)“
\item Für Unterabschnitte: „Abschnitt \(n.m\)“, wobei \(n\) die
  Abschnittsnummer ist. Das Wort Unterabschnitt wird nicht verwendet.
\item Für Unterunterabschnitte: „Abschnitt \(n.m.k\)“, wobei \(m\) die
  Unterabschnittsnummer und \(n\) die Abschnittsnummer ist. Das Wort
  Unterunterabschnitt wird nicht verwendet.
\item Benamte Absätze: Verweise auf benamte Absätze sollten vermieden werden.
\end{itemize}
\bigskip

Die Beiträge zu tagungsbandartigen Berichten sollten nicht gegenseitig
aufeinander verwisen, soweit möglich.

Der \cs{autoref}"=Befehl kann auch verwendet werden um auf Fließumgebungen wie
Abbildungen zu verweisen.


\end{ger}
\end{paracol}

\begin{paracol}{2}
\begin{eng}
\subsection{Bibliographic References}
\label{sec:biblio}
\end{eng}
\begin{ger}
\subsection{Zitier"~ und Literaturstil}
\end{ger}
\end{paracol}

\DescribeMacro{cite}
\begin{paracol}{2}
\begin{eng}
For citations and bibliographies, a \emph{numeric} citation style is used.
The numbers derive from the \emph{alphabetic} sorting of the list of
bibliographic entries at the end of the report (or the end of the individual
contributions in collection works, if applicable). Given names are
abbreviated.

\begingroup\normalfont
\vspace*{\baselineskip}
\parbox[t]{1.5em}{[1]}\parbox[t]{\dimexpr\linewidth - 2em}{%
I.~Nassi and B.~Shneiderman.
\newblock Flowchart techniques for structured programming.
\newblock {\em SIGPLAN Not.}, 8(8):12--26, 1973.}
\vspace*{\baselineskip}
\endgroup

This corresponds to the \emph{plain} \BibTeX style, or the
\emph{numeric-comp} style with abbreviations for Biblatex. Either way, the
citation style is preselected. If in doubt, the Biblatex variant should be
used.

\remark{The citation and bibliographic style is not to
be changed.}

While \BibTeX should work fine and is supported, the use of Biblatex,
especially with its \emph{biber} backend is encouraged to support proper use of
Unicode characters and fonts. %^^A TODO: ref biblatex
Collection works \emph{must} use Biblatex. For a list of kinds of works to cite
as supported by \BibTeX and Biblatex refer to \autoref{tbl:bibtytpes}. Kinds of
work not listed should use the \emph{misc} type.
\end{eng}
\begin{ger}
In Zitaten und Literaturlisten wird ein einfacher, \emph{numerischer} Stil
genutzt. Die Nummerierung folgt der \emph{alphabetischen} Sortierung der
Literatureinträge in der Literaturliste am Ende des Berichts (oder am Ende
der Einzelbeiträge in sammlungsartigen Berichten, sofern angebracht).
Vornamen werden abgekürzt.

\begingroup\normalfont
\vspace*{\baselineskip}
\parbox[t]{1.5em}{[1]}\parbox[t]{\dimexpr\linewidth - 2em}{%
I.~Nassi and B.~Shneiderman.
\newblock Flowchart techniques for structured programming.
\newblock {\em SIGPLAN Not.}, 8(8):12--26, 1973.}
\vspace*{\baselineskip}
\endgroup

Dies entspricht dem \emph{plain}-Stil von \BibTeX, beziehungsweise dem
\emph{numeric-comp}-Stil mit Namensabkürzungen in Biblatex. In jedem Fall ist
der Stil schon vorausgewählt. Im Zweifel ist die Variante nach Biblatex
maßgeblich.

\remark{Weder Zitier"~ noch Literaturstil dürfen verändert werden.}

Obwohl \BibTeX\ gut funktionieren sollte und auch unterstützt wird, wird
Biblatex, insbesondere mit dem \emph{biber}-Backend empfohlen, da dies eine
vernünftige Verwendung von Unicodezeichen und "~schriften erlaubt.
Sammlungsartige Berichte \emph{müssen} Biblatex benutzen. Eine Liste aller
von \BibTeX\ und Biblatex unterstützten zu zitierenden Werkarten findet sich
in \autoref{tbl:bibtytpes}. Nicht aufgeführte Werkarten erhalten den Typ
\emph{misc}.
\end{ger}
\end{paracol}

\begin{table}[htbp]
  \makeatletter
  \let\sellang\select@language
  \makeatother
  \smaller
  \centering
  \begin{threeparttable}
    \caption{%
    \textenglish{Supported bibliography entry types} / %
    \textgerman{\em Unterstützte Bibliographieeintragsarten}
    \hspace{\textwidth}\relax D %^^A I am a sacrifice Oo
    \textenglish{Default type is indicated; alias entry types in italic} /
    \textgerman{\em Standardeintragsart ist markiert; Parallelbezeichnungen kursiv}
    }
    \label{tbl:bibtytpes}
    \begin{tabular}{>{\relax}l>{\relax}l>{\sellang{english}\RaggedRight}p{.34\linewidth}>{\sellang{ngerman}\em\RaggedRight}p{.34\linewidth}}
    \toprule
    \BibTeX           & Biblatex                   &                      & \\
    \midrule
    article           & article                    & articles in journal, magazine \&c & Zeitschriften"~, Magazin"~ und andere Artikel \\
                      & \textit{suppperiodical}      & supplemental material in periodicals & Zusatzmaterialien in Periodika \\
                      & \textit{review}              & reviews of other works & Rezensionen anderer Arbeiten \\
    book              & book                       & books & Bücher\\
                      & \textit{mvbook}              & multi-volume --- & Mehrbändige --- \\
    booklet           & booklet                    & book-like work without publisher & Buchartiges nicht-verlegtes Werk \\
                      & collection                 & collection of multiple independent contributions &  Sammlung eigenständiger Werke \\
                      & \textit{mvcollection}        & multi-volume --- & Mehrbändige --- \\
                      & \textit{reference}           & references such as dictionaries & Nachschlagewerke wie Wörterbücher\\
                      & \textit{mvreference}         & multi-volume --- & Mehrbändige --- \\
    inbook            & inbook\tnote{a}            & independent part of a book & Eigenständiger Buchteil \\
                      & \textit{bookinbook}          & part of a book that originally was a book & Buchteil, der schon als eigenständiges Buch verlegt wurde \\
                      & \textit{suppbook}            & supplemental material in books & Zusatzmaterialien in Büchern \\
    incollection      & incollection               & independent contribution to a collection & Eigenständiges Werk, das einer Sammlung ist \\
                      & \textit{suppcollection}      & supplemental material in a collection & Zusatzmaterialien in Sammlungen \\
                      & \textit{inreference}         & articles in works of references & Artikel in Nachschlagewerken\\
    inproceedings     & inproceedings              & articles in conference proceedings & Tagungsbandartikel\\
    \textit{conference} & \textit{conference}          & --- ditto & --- dito \\
    manual            & manual                     & documentation works & Handbücher \\
    mastersthesis     & mastersthesis\tnote{b}     & Master’s theses & Master"~ oder Magisterarbeiten \\
\llap{☞} misc        & misc                        & anything (default) & sonstiges (Vorgabewert)\\
                      & online                     & online resource like web sites & Internetquellen wie Webseiten \\
                      & \textit{www}                 & --- ditto & --- dito \\
                      & \textit{electronic}          & --- ditto & --- dito \\
    phdthesis         & phdthesis\tnote{b}         & doctoral dissertation & Dissertation \\
                      & patent                     & patent entries & Patente \\
                      & periodical                 & complete preriodical issue & Ganze Zeitschriftenausgabe \\
    proceedings       & proceedings                & conference proceeding & Konferenz"~ und Tagungsbändge \\
                      & \textit{mvproceedings}       & multi-volume --- & Mehrbändige --- \\
                      & report                     & institutionally published report & Von Institutionen veröffentlichte Berichte\\
    techreport        & \textit{techreport}\tnote{c} & technical reports & Technische Berichte\\
                      & thesis                     & theses submitted to educational institutins & Abschlussarbeiten \\
                      & \textit{mastersthesis}       & (see above) & (siehe oben) \\
                      & \textit{phdthesis}           & (see above) & (siehe oben) \\
    unpublished       & unpublished                & works not formally published & Nicht offiziell veröffentlichte Werke \\
    \bottomrule
    \end{tabular}
    \begin{tablenotes}
    \item [a] Behaves differently than \BibTeX / \emph{Verhält sich anders
    als in \BibTeX}
    \item [b] Actually a subtype of thesis / \emph{Eigentlich eine thesis-Unterart}
    \item [c] Actually a subtype of report / \emph{Eigentlich eine report-Unterart}
    \end{tablenotes}
  \end{threeparttable}
\end{table}
\begin{paracol}{2}
\begin{eng}
\section{Miscellanea}
\end{eng}
\begin{ger}
\section{Verschiedenes}
\end{ger}
\end{paracol}
\begin{Describe}
  \DescribeOption{copyrightmark}\\
  \DescribeValue{copyrightmark}{true}\\
  \DescribeValue{copyrightmark}{false}\\
\end{Describe}
\begin{paracol}{2}
\begin{eng}
\subsection{Copyright metadata}

By default, a copyright mark of the form ``Copyright (c) \the\year, HPI'' is
added to the metadata of the resulting PDF file. This corresponds to the option
|copyrightmark| or |copyrightmark=true|. To not add the information, use
|copyrightmark=false|.
\end{eng}
\begin{ger}
\subsection{Coyprightvermerk in den Metadaten}

Standardmäßig wird eine Vermerk der form "`Copyright (c) \the\year, HPI"' dem
erzeugten PDF hinzugefügt, was der Option |copyrightmark| oder
|copyrightmark=true| entspricht. Um den Vermerk zu verindern, sollte die Option
|copyrightmark=false| verwendet werden.
\end{ger}
\end{paracol}


\begin{Describe}
  \DescribeOption{draft}\\
  \DescribeValue{draft}{true}\\
  \DescribeValue{draft}{full}\\
  \DescribeOption{todotools}
\end{Describe}
\begin{paracol}{2}
\begin{eng}
\subsection{Draft tools}

To support editing early versions of reports, the |draft| or |draft=true|
option can be used to activate a gray bar at the to and the bottom that says
``Draft''. Many \LaTeX\ packages also react to the |draft| option. Unlike the
typical effect of the |draft| option, which also disables graphics, the
\File{hpitr} class makes sure that graphics are displayed also in the draft
version. To avoid that, use |draft=full|.

The |todotools=true| option loads the \File{todonotes} packages (in draft mode)
and provides a few additional commands.
\end{eng}
\begin{ger}
\subsection{Edierhilfen}

Zur Unterstüzung von Bericht"=vorversionen schaletet die Klassenoption
|draft| (oder |draft=true|) einen grauen Balken mit der Aufschrift „Draft“ am
Seitenanfang und "~ende ein. Viele \LaTeX"=Pakete reagieren ebenfalls auf die
|draft|"=Option. Normalerweise schaltet dies auch alle Bilder ab. Die
\File{hpitr}"=Klasse sorgt jedoch dafür, dass alle Bilder auch in Vorversionen
ins Dokument übernommen werden. Sollen Bilder außen vor bleiben, kann die
|draft=full|"=Option genutzt werden.

Die Option |todotools=true| lädt das \File{todonotes}"=Paket und stellt einige
zusätzliche Editierbefehle bereit.
\end{ger}
\end{paracol}

\begin{paracol}{2}
\begin{eng}
\subsection{\LaTeX\ Packages}

The following packages are automatically loaded by the \File{hpitr} class.
\end{eng}
\begin{ger}
\subsection{\LaTeX"=Pakete}
Die folgenden Pakte werden von der \File{hpitr}"=Klasse automatisch geladen.
\end{ger}
\end{paracol}

\begin{multicols}{3}
{\color{DarkGreen}
\begin{itemize}
\item \File{amsmath}
\item \File{amssymb}
\item \File{babel}
\item \File{biblatex} \emph{collections\,/\,proceedings only}
\item \File{blindtext} \emph{draft only}
\item \File{booktabs}
\item \File{color}
\item \File{csquotes}
\item \File{eso-pic} \emph{draft only}
\item \File{etoolbox}
\item \File{eulervm}
\item \File{expl3}
\item \File{fixltx2e}
\item \File{fontenc} \pdfTeX\ \emph{only}
\item \File{fontspec} \LuaTeX/\XeTeX\ \emph{only}
\item \File{graphicx}
\item \File{grffile}
\item \File{hyperref}
\item \File{hyperxmp}
\item \File{hyphsubst}
\item \File{ifdraft}
\item \File{ifluatex}
\item \File{ifthen}
\item \File{ifxetex}
\item \File{inputenc}
\item \File{longtable}
\item \File{mathcomp}
\item \File{mathpazo} \pdfTeX\ \emph{only}
\item \File{microtype}
\item \File{pdfpages} \emph{proceedings only}
\item \File{ragged2e} \emph{collections\,/\,proceedings only}
\item \File{relsize}
\item \File{scrbase}
\item \File{scrhack}
\item \File{scrlayer-scrpage}
\item \File{siunitx}
\item \File{sourcecodepro}
\item \File{sourcesanspro}
\item \File{tabularx}
\item \File{textcomp}
\item \File{tocbasic}
\item \File{todonotes} \emph{draft only}
\item \File{xcolor}
\item \File{xparse}
\item \File{xspace}
\end{itemize}}
\end{multicols}

\begin{paracol}{2}
\begin{eng}
\par\noindent The following packages \emph{must not} be loaded.
\end{eng}
\begin{ger}
\par\noindent Die folgenden Pakte \emph{dürfen nicht} geladen werden.
\end{ger}
\end{paracol}

\begin{multicols}{3}
{\color{DarkRed}
\begin{itemize}
\item \File{SIstyle}
\item \File{SIunits}
\item \File{a4wide}
\item \File{a4}
\item \File{aecompl}
\item \File{ae}
\item \File{caption2}
\item \File{cite} \emph{in collections}
\item \File{courier}
\item \File{doublespace}
\item \File{epsfig}
\item \File{epsf}
\item \File{euler}
\item \File{fancyhdr}
\item \File{fancyheadings}
\item \File{fourier}
\item \File{geometry}
\item \File{glossary}
\item \File{helvet}
\item \File{isolatin}
\item \File{mathpple}
\item \File{mathptmx}
\item \File{mathptm}
\item \File{newtxmath}
\item \File{newtxtext}
\item \File{palatino}
\item \File{psfig}
\item \File{pslatex}
\item \File{scrpage}
\item \File{subfigure}
\item \File{subfig}
\item \File{t1enc}
\item \File{times}
\item \File{umlaut}
\item \File{utopia}
\item \File{zefonts}
\end{itemize}}
\end{multicols}

\begin{paracol}{2}
\begin{eng}
\section{Troubleshooting}
\end{eng}
\begin{ger}
\section{Fehlerbehebung}
\end{ger}
\end{paracol}

\begin{paracol}{2}
\begin{eng}
\subsection{Biber}
\end{eng}
\begin{ger}
\subsection{Biber}
\end{ger}
\end{paracol}

\begin{paracol}{2}
\begin{eng}
Biber may complain about ``missing files'', such as
\end{eng}
\begin{ger}
Biber beklagt sich zeitweise über "`fehlende
Dateien"', z.\,B.
\end{ger}
 \end{paracol}
\par\smallskip
{\centering\ttfamily\bfseries
read\_file '\meta{\textit{a path}}/recode\_data.xml' -
sysopen: No such file or directory at \meta{\textit{another path}}/bda77484.pm
line 112.
\par}
\medskip
\begin{paracol}{2}
\begin{eng}
  \noindent The reason for this error is the Biber's cach directory is
  corrupted. This is unfortunate but not problematic. The location of Biber's
  cache directory can be obtained with \lstinline|biber -cache|. Just deleting
  this directory should resolve this error. Biber's next run will just be a
  little bit slower.
\end{eng}
\begin{ger}
  \noindent Der Grund liegt in einem kaputten oder unvollständigem
  Cache"=Verzeichins. Das ist zwar unerfreulich aber nicht problematisch. Wird
  das Cache"=Verzeichnis (mit \lstinline|biber -cache| herauszufinden)
  gelöscht, wird Biber es beim nächsten Lauf wieder korrekt angelegen und der
  Fehler ist behoben.
\end{ger}
\end{paracol}

%</manual>
\DocInput{hpitr.dtx}
\end{document}
%</!README>
%    \end{macrocode}
% \iffalse meta-comment
%</doc|manual|README>
% \fi^^A meta-comment
%
% \Finale
%
\endinput

%% Local Variables:
%% TeX-master: t
%% End:

\begin{paracol}{2}
\begin{eng}
..
\end{eng}
\begin{ger}
..
\end{ger}
\end{paracol}
